(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * @version: 1.0 Alpha-1
 * @author: Coolite Inc. http://www.coolite.com/
 * @date: 2008-05-13
 * @copyright: Copyright (c) 2006-2008, Coolite Inc. (http://www.coolite.com/). All rights reserved.
 * @license: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/. 
 * @website: http://www.datejs.com/
 */
Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};
(function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo,p=function(s,l){if(!l){l=2;}
return("000"+s).slice(l*-1);};$P.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this;};$P.setTimeToNow=function(){var n=new Date();this.setHours(n.getHours());this.setMinutes(n.getMinutes());this.setSeconds(n.getSeconds());this.setMilliseconds(n.getMilliseconds());return this;};$D.today=function(){return new Date().clearTime();};$D.compare=function(date1,date2){if(isNaN(date1)||isNaN(date2)){throw new Error(date1+" - "+date2);}else if(date1 instanceof Date&&date2 instanceof Date){return(date1<date2)?-1:(date1>date2)?1:0;}else{throw new TypeError(date1+" - "+date2);}};$D.equals=function(date1,date2){return(date1.compareTo(date2)===0);};$D.getDayNumberFromName=function(name){var n=$C.dayNames,m=$C.abbreviatedDayNames,o=$C.shortestDayNames,s=name.toLowerCase();for(var i=0;i<n.length;i++){if(n[i].toLowerCase()==s||m[i].toLowerCase()==s||o[i].toLowerCase()==s){return i;}}
return-1;};$D.getMonthNumberFromName=function(name){var n=$C.monthNames,m=$C.abbreviatedMonthNames,s=name.toLowerCase();for(var i=0;i<n.length;i++){if(n[i].toLowerCase()==s||m[i].toLowerCase()==s){return i;}}
return-1;};$D.isLeapYear=function(year){return((year%4===0&&year%100!==0)||year%400===0);};$D.getDaysInMonth=function(year,month){return[31,($D.isLeapYear(year)?29:28),31,30,31,30,31,31,30,31,30,31][month];};$D.getTimezoneAbbreviation=function(offset){var z=$C.timezones,p;for(var i=0;i<z.length;i++){if(z[i].offset===offset){return z[i].name;}}
return null;};$D.getTimezoneOffset=function(name){var z=$C.timezones,p;for(var i=0;i<z.length;i++){if(z[i].name===name.toUpperCase()){return z[i].offset;}}
return null;};$P.clone=function(){return new Date(this.getTime());};$P.compareTo=function(date){return Date.compare(this,date);};$P.equals=function(date){return Date.equals(this,date||new Date());};$P.between=function(start,end){return this.getTime()>=start.getTime()&&this.getTime()<=end.getTime();};$P.isAfter=function(date){return this.compareTo(date||new Date())===1;};$P.isBefore=function(date){return(this.compareTo(date||new Date())===-1);};$P.isToday=function(){return this.isSameDay(new Date());};$P.isSameDay=function(date){return this.clone().clearTime().equals(date.clone().clearTime());};$P.addMilliseconds=function(value){this.setMilliseconds(this.getMilliseconds()+value);return this;};$P.addSeconds=function(value){return this.addMilliseconds(value*1000);};$P.addMinutes=function(value){return this.addMilliseconds(value*60000);};$P.addHours=function(value){return this.addMilliseconds(value*3600000);};$P.addDays=function(value){this.setDate(this.getDate()+value);return this;};$P.addWeeks=function(value){return this.addDays(value*7);};$P.addMonths=function(value){var n=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+value);this.setDate(Math.min(n,$D.getDaysInMonth(this.getFullYear(),this.getMonth())));return this;};$P.addYears=function(value){return this.addMonths(value*12);};$P.add=function(config){if(typeof config=="number"){this._orient=config;return this;}
var x=config;if(x.milliseconds){this.addMilliseconds(x.milliseconds);}
if(x.seconds){this.addSeconds(x.seconds);}
if(x.minutes){this.addMinutes(x.minutes);}
if(x.hours){this.addHours(x.hours);}
if(x.weeks){this.addWeeks(x.weeks);}
if(x.months){this.addMonths(x.months);}
if(x.years){this.addYears(x.years);}
if(x.days){this.addDays(x.days);}
return this;};var $y,$m,$d;$P.getWeek=function(){var a,b,c,d,e,f,g,n,s,w;$y=(!$y)?this.getFullYear():$y;$m=(!$m)?this.getMonth()+1:$m;$d=(!$d)?this.getDate():$d;if($m<=2){a=$y-1;b=(a/4|0)-(a/100|0)+(a/400|0);c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0);s=b-c;e=0;f=$d-1+(31*($m-1));}else{a=$y;b=(a/4|0)-(a/100|0)+(a/400|0);c=((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0);s=b-c;e=s+1;f=$d+((153*($m-3)+2)/5)+58+s;}
g=(a+b)%7;d=(f+g-e)%7;n=(f+3-d)|0;if(n<0){w=53-((g-s)/5|0);}else if(n>364+s){w=1;}else{w=(n/7|0)+1;}
$y=$m=$d=null;return w;};$P.getISOWeek=function(){$y=this.getUTCFullYear();$m=this.getUTCMonth()+1;$d=this.getUTCDate();return p(this.getWeek());};$P.setWeek=function(n){return this.moveToDayOfWeek(1).addWeeks(n-this.getWeek());};$D._validate=function(n,min,max,name){if(typeof n=="undefined"){return false;}else if(typeof n!="number"){throw new TypeError(n+" is not a Number.");}else if(n<min||n>max){throw new RangeError(n+" is not a valid value for "+name+".");}
return true;};$D.validateMillisecond=function(value){return $D._validate(value,0,999,"millisecond");};$D.validateSecond=function(value){return $D._validate(value,0,59,"second");};$D.validateMinute=function(value){return $D._validate(value,0,59,"minute");};$D.validateHour=function(value){return $D._validate(value,0,23,"hour");};$D.validateDay=function(value,year,month){return $D._validate(value,1,$D.getDaysInMonth(year,month),"day");};$D.validateMonth=function(value){return $D._validate(value,0,11,"month");};$D.validateYear=function(value){return $D._validate(value,0,9999,"year");};$P.set=function(config){if($D.validateMillisecond(config.millisecond)){this.addMilliseconds(config.millisecond-this.getMilliseconds());}
if($D.validateSecond(config.second)){this.addSeconds(config.second-this.getSeconds());}
if($D.validateMinute(config.minute)){this.addMinutes(config.minute-this.getMinutes());}
if($D.validateHour(config.hour)){this.addHours(config.hour-this.getHours());}
if($D.validateMonth(config.month)){this.addMonths(config.month-this.getMonth());}
if($D.validateYear(config.year)){this.addYears(config.year-this.getFullYear());}
if($D.validateDay(config.day,this.getFullYear(),this.getMonth())){this.addDays(config.day-this.getDate());}
if(config.timezone){this.setTimezone(config.timezone);}
if(config.timezoneOffset){this.setTimezoneOffset(config.timezoneOffset);}
if(config.week&&$D._validate(config.week,0,53,"week")){this.setWeek(config.week);}
return this;};$P.moveToFirstDayOfMonth=function(){return this.set({day:1});};$P.moveToLastDayOfMonth=function(){return this.set({day:$D.getDaysInMonth(this.getFullYear(),this.getMonth())});};$P.moveToNthOccurrence=function(dayOfWeek,occurrence){var shift=0;if(occurrence>0){shift=occurrence-1;}
else if(occurrence===-1){this.moveToLastDayOfMonth();if(this.getDay()!==dayOfWeek){this.moveToDayOfWeek(dayOfWeek,-1);}
return this;}
return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(dayOfWeek,+1).addWeeks(shift);};$P.moveToDayOfWeek=function(dayOfWeek,orient){var diff=(dayOfWeek-this.getDay()+7*(orient||+1))%7;return this.addDays((diff===0)?diff+=7*(orient||+1):diff);};$P.moveToMonth=function(month,orient){var diff=(month-this.getMonth()+12*(orient||+1))%12;return this.addMonths((diff===0)?diff+=12*(orient||+1):diff);};$P.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1;};$P.getTimezone=function(){return $D.getTimezoneAbbreviation(this.getUTCOffset());};$P.setTimezoneOffset=function(offset){var here=this.getTimezoneOffset(),there=Number(offset)*-6/10;return this.addMinutes(there-here);};$P.setTimezone=function(offset){return this.setTimezoneOffset($D.getTimezoneOffset(offset));};$P.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset());};$P.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset());};$P.getUTCOffset=function(){var n=this.getTimezoneOffset()*-10/6,r;if(n<0){r=(n-10000).toString();return r.charAt(0)+r.substr(2);}else{r=(n+10000).toString();return"+"+r.substr(1);}};$P.getElapsed=function(date){return(date||new Date())-this;};if(!$P.toISOString){$P.toISOString=function(){function f(n){return n<10?'0'+n:n;}
return'"'+this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z"';};}
$P._toString=$P.toString;$P.toString=function(format){var x=this;if(format&&format.length==1){var c=$C.formatPatterns;x.t=x.toString;switch(format){case"d":return x.t(c.shortDate);case"D":return x.t(c.longDate);case"F":return x.t(c.fullDateTime);case"m":return x.t(c.monthDay);case"r":return x.t(c.rfc1123);case"s":return x.t(c.sortableDateTime);case"t":return x.t(c.shortTime);case"T":return x.t(c.longTime);case"u":return x.t(c.universalSortableDateTime);case"y":return x.t(c.yearMonth);}}
var ord=function(n){switch(n*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th";}};return format?format.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(m){if(m.charAt(0)==="\\"){return m.replace("\\","");}
x.h=x.getHours;switch(m){case"hh":return p(x.h()<13?(x.h()===0?12:x.h()):(x.h()-12));case"h":return x.h()<13?(x.h()===0?12:x.h()):(x.h()-12);case"HH":return p(x.h());case"H":return x.h();case"mm":return p(x.getMinutes());case"m":return x.getMinutes();case"ss":return p(x.getSeconds());case"s":return x.getSeconds();case"yyyy":return p(x.getFullYear(),4);case"yy":return p(x.getFullYear());case"dddd":return $C.dayNames[x.getDay()];case"ddd":return $C.abbreviatedDayNames[x.getDay()];case"dd":return p(x.getDate());case"d":return x.getDate();case"MMMM":return $C.monthNames[x.getMonth()];case"MMM":return $C.abbreviatedMonthNames[x.getMonth()];case"MM":return p((x.getMonth()+1));case"M":return x.getMonth()+1;case"t":return x.h()<12?$C.amDesignator.substring(0,1):$C.pmDesignator.substring(0,1);case"tt":return x.h()<12?$C.amDesignator:$C.pmDesignator;case"S":return ord(x.getDate());default:return m;}}):this._toString();};}());
(function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo,$N=Number.prototype;$P._orient=+1;$P._nth=null;$P._is=false;$P._same=false;$P._isSecond=false;$N._dateElement="day";$P.next=function(){this._orient=+1;return this;};$D.next=function(){return $D.today().next();};$P.last=$P.prev=$P.previous=function(){this._orient=-1;return this;};$D.last=$D.prev=$D.previous=function(){return $D.today().last();};$P.is=function(){this._is=true;return this;};$P.same=function(){this._same=true;this._isSecond=false;return this;};$P.today=function(){return this.same().day();};$P.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun());}
return false;};$P.at=function(time){return(typeof time==="string")?$D.parse(this.toString("d")+" "+time):this.set(time);};$N.fromNow=$N.after=function(date){var c={};c[this._dateElement]=this;return((!date)?new Date():date.clone()).add(c);};$N.ago=$N.before=function(date){var c={};c[this._dateElement]=this*-1;return((!date)?new Date():date.clone()).add(c);};var dx=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),mx=("january february march april may june july august september october november december").split(/\s/),px=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),pxf=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),nth=("final first second third fourth fifth").split(/\s/),de;$P.toObject=function(){var o={};for(var i=0;i<px.length;i++){o[px[i].toLowerCase()]=this["get"+pxf[i]]();}
return o;};$D.fromObject=function(config){config.week=null;return Date.today().set(config);};var df=function(n){return function(){if(this._is){this._is=false;return this.getDay()==n;}
if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1);}
this._isSecond=false;var ntemp=this._nth;this._nth=null;var temp=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(n,ntemp);if(this>temp){throw new RangeError($D.getDayName(n)+" does not occur "+ntemp+" times in the month of "+$D.getMonthName(temp.getMonth())+" "+temp.getFullYear()+".");}
return this;}
return this.moveToDayOfWeek(n,this._orient);};};var sdf=function(n){return function(){var t=$D.today(),shift=n-t.getDay();if(n===0&&$C.firstDayOfWeek===1&&t.getDay()!==0){shift=shift+7;}
return t.addDays(shift);};};for(var i=0;i<dx.length;i++){$D[dx[i].toUpperCase()]=$D[dx[i].toUpperCase().substring(0,3)]=i;$D[dx[i]]=$D[dx[i].substring(0,3)]=sdf(i);$P[dx[i]]=$P[dx[i].substring(0,3)]=df(i);}
var mf=function(n){return function(){if(this._is){this._is=false;return this.getMonth()===n;}
return this.moveToMonth(n,this._orient);};};var smf=function(n){return function(){return $D.today().set({month:n,day:1});};};for(var j=0;j<mx.length;j++){$D[mx[j].toUpperCase()]=$D[mx[j].toUpperCase().substring(0,3)]=j;$D[mx[j]]=$D[mx[j].substring(0,3)]=smf(j);$P[mx[j]]=$P[mx[j].substring(0,3)]=mf(j);}
var ef=function(j){return function(){if(this._isSecond){this._isSecond=false;return this;}
if(this._same){this._same=this._is=false;var o1=this.toObject(),o2=(arguments[0]||new Date()).toObject(),v="",k=j.toLowerCase();for(var m=(px.length-1);m>-1;m--){v=px[m].toLowerCase();if(o1[v]!=o2[v]){return false;}
if(k==v){break;}}
return true;}
if(j.substring(j.length-1)!="s"){j+="s";}
return this["add"+j](this._orient);};};var nf=function(n){return function(){this._dateElement=n;return this;};};for(var k=0;k<px.length;k++){de=px[k].toLowerCase();$P[de]=$P[de+"s"]=ef(px[k]);$N[de]=$N[de+"s"]=nf(de);}
$P._ss=ef("Second");var nthfn=function(n){return function(dayOfWeek){if(this._same){return this._ss(arguments[0]);}
if(dayOfWeek||dayOfWeek===0){return this.moveToNthOccurrence(dayOfWeek,n);}
this._nth=n;if(n===2&&(dayOfWeek===undefined||dayOfWeek===null)){this._isSecond=true;return this.addSeconds(this._orient);}
return this;};};for(var l=0;l<nth.length;l++){$P[nth[l]]=(l===0)?nthfn(-1):nthfn(l);}}());
(function(){Date.Parsing={Exception:function(s){this.message="Parse error at '"+s.substring(0,10)+" ...'";}};var $P=Date.Parsing;var _=$P.Operators={rtoken:function(r){return function(s){var mx=s.match(r);if(mx){return([mx[0],s.substring(mx[0].length)]);}else{throw new $P.Exception(s);}};},token:function(s){return function(s){return _.rtoken(new RegExp("^\s*"+s+"\s*"))(s);};},stoken:function(s){return _.rtoken(new RegExp("^"+s));},until:function(p){return function(s){var qx=[],rx=null;while(s.length){try{rx=p.call(this,s);}catch(e){qx.push(rx[0]);s=rx[1];continue;}
break;}
return[qx,s];};},many:function(p){return function(s){var rx=[],r=null;while(s.length){try{r=p.call(this,s);}catch(e){return[rx,s];}
rx.push(r[0]);s=r[1];}
return[rx,s];};},optional:function(p){return function(s){var r=null;try{r=p.call(this,s);}catch(e){return[null,s];}
return[r[0],r[1]];};},not:function(p){return function(s){try{p.call(this,s);}catch(e){return[null,s];}
throw new $P.Exception(s);};},ignore:function(p){return p?function(s){var r=null;r=p.call(this,s);return[null,r[1]];}:null;},product:function(){var px=arguments[0],qx=Array.prototype.slice.call(arguments,1),rx=[];for(var i=0;i<px.length;i++){rx.push(_.each(px[i],qx));}
return rx;},cache:function(rule){var cache={},r=null;return function(s){try{r=cache[s]=(cache[s]||rule.call(this,s));}catch(e){r=cache[s]=e;}
if(r instanceof $P.Exception){throw r;}else{return r;}};},any:function(){var px=arguments;return function(s){var r=null;for(var i=0;i<px.length;i++){if(px[i]==null){continue;}
try{r=(px[i].call(this,s));}catch(e){r=null;}
if(r){return r;}}
throw new $P.Exception(s);};},each:function(){var px=arguments;return function(s){var rx=[],r=null;for(var i=0;i<px.length;i++){if(px[i]==null){continue;}
try{r=(px[i].call(this,s));}catch(e){throw new $P.Exception(s);}
rx.push(r[0]);s=r[1];}
return[rx,s];};},all:function(){var px=arguments,_=_;return _.each(_.optional(px));},sequence:function(px,d,c){d=d||_.rtoken(/^\s*/);c=c||null;if(px.length==1){return px[0];}
return function(s){var r=null,q=null;var rx=[];for(var i=0;i<px.length;i++){try{r=px[i].call(this,s);}catch(e){break;}
rx.push(r[0]);try{q=d.call(this,r[1]);}catch(ex){q=null;break;}
s=q[1];}
if(!r){throw new $P.Exception(s);}
if(q){throw new $P.Exception(q[1]);}
if(c){try{r=c.call(this,r[1]);}catch(ey){throw new $P.Exception(r[1]);}}
return[rx,(r?r[1]:s)];};},between:function(d1,p,d2){d2=d2||d1;var _fn=_.each(_.ignore(d1),p,_.ignore(d2));return function(s){var rx=_fn.call(this,s);return[[rx[0][0],r[0][2]],rx[1]];};},list:function(p,d,c){d=d||_.rtoken(/^\s*/);c=c||null;return(p instanceof Array?_.each(_.product(p.slice(0,-1),_.ignore(d)),p.slice(-1),_.ignore(c)):_.each(_.many(_.each(p,_.ignore(d))),px,_.ignore(c)));},set:function(px,d,c){d=d||_.rtoken(/^\s*/);c=c||null;return function(s){var r=null,p=null,q=null,rx=null,best=[[],s],last=false;for(var i=0;i<px.length;i++){q=null;p=null;r=null;last=(px.length==1);try{r=px[i].call(this,s);}catch(e){continue;}
rx=[[r[0]],r[1]];if(r[1].length>0&&!last){try{q=d.call(this,r[1]);}catch(ex){last=true;}}else{last=true;}
if(!last&&q[1].length===0){last=true;}
if(!last){var qx=[];for(var j=0;j<px.length;j++){if(i!=j){qx.push(px[j]);}}
p=_.set(qx,d).call(this,q[1]);if(p[0].length>0){rx[0]=rx[0].concat(p[0]);rx[1]=p[1];}}
if(rx[1].length<best[1].length){best=rx;}
if(best[1].length===0){break;}}
if(best[0].length===0){return best;}
if(c){try{q=c.call(this,best[1]);}catch(ey){throw new $P.Exception(best[1]);}
best[1]=q[1];}
return best;};},forward:function(gr,fname){return function(s){return gr[fname].call(this,s);};},replace:function(rule,repl){return function(s){var r=rule.call(this,s);return[repl,r[1]];};},process:function(rule,fn){return function(s){var r=rule.call(this,s);return[fn.call(this,r[0]),r[1]];};},min:function(min,rule){return function(s){var rx=rule.call(this,s);if(rx[0].length<min){throw new $P.Exception(s);}
return rx;};}};var _generator=function(op){return function(){var args=null,rx=[];if(arguments.length>1){args=Array.prototype.slice.call(arguments);}else if(arguments[0]instanceof Array){args=arguments[0];}
if(args){for(var i=0,px=args.shift();i<px.length;i++){args.unshift(px[i]);rx.push(op.apply(null,args));args.shift();return rx;}}else{return op.apply(null,arguments);}};};var gx="optional not ignore cache".split(/\s/);for(var i=0;i<gx.length;i++){_[gx[i]]=_generator(_[gx[i]]);}
var _vector=function(op){return function(){if(arguments[0]instanceof Array){return op.apply(null,arguments[0]);}else{return op.apply(null,arguments);}};};var vx="each any all".split(/\s/);for(var j=0;j<vx.length;j++){_[vx[j]]=_vector(_[vx[j]]);}}());(function(){var $D=Date,$P=$D.prototype,$C=$D.CultureInfo;var flattenAndCompact=function(ax){var rx=[];for(var i=0;i<ax.length;i++){if(ax[i]instanceof Array){rx=rx.concat(flattenAndCompact(ax[i]));}else{if(ax[i]){rx.push(ax[i]);}}}
return rx;};$D.Grammar={};$D.Translator={hour:function(s){return function(){this.hour=Number(s);};},minute:function(s){return function(){this.minute=Number(s);};},second:function(s){return function(){this.second=Number(s);};},meridian:function(s){return function(){this.meridian=s.slice(0,1).toLowerCase();};},timezone:function(s){return function(){var n=s.replace(/[^\d\+\-]/g,"");if(n.length){this.timezoneOffset=Number(n);}else{this.timezone=s.toLowerCase();}};},day:function(x){var s=x[0];return function(){this.day=Number(s.match(/\d+/)[0]);};},month:function(s){return function(){this.month=(s.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(s)/4:Number(s)-1;};},year:function(s){return function(){var n=Number(s);this.year=((s.length>2)?n:(n+(((n+2000)<$C.twoDigitYearMax)?2000:1900)));};},rday:function(s){return function(){switch(s){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break;}};},finishExact:function(x){x=(x instanceof Array)?x:[x];for(var i=0;i<x.length;i++){if(x[i]){x[i].call(this);}}
var now=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=now.getDate();}
if(!this.year){this.year=now.getFullYear();}
if(!this.month&&this.month!==0){this.month=now.getMonth();}
if(!this.day){this.day=1;}
if(!this.hour){this.hour=0;}
if(!this.minute){this.minute=0;}
if(!this.second){this.second=0;}
if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else if(this.meridian=="a"&&this.hour==12){this.hour=0;}}
if(this.day>$D.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.");}
var r=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){r.set({timezone:this.timezone});}else if(this.timezoneOffset){r.set({timezoneOffset:this.timezoneOffset});}
return r;},finish:function(x){x=(x instanceof Array)?flattenAndCompact(x):[x];if(x.length===0){return null;}
for(var i=0;i<x.length;i++){if(typeof x[i]=="function"){x[i].call(this);}}
var today=$D.today();if(this.now&&!this.unit&&!this.operator){return new Date();}else if(this.now){today=new Date();}
var expression=!!(this.days&&this.days!==null||this.orient||this.operator);var gap,mod,orient;orient=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){today.setTimeToNow();}
if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;expression=true;}}
if(!expression&&this.weekday&&!this.day&&!this.days){var temp=Date[this.weekday]();this.day=temp.getDate();if(!this.month){this.month=temp.getMonth();}
this.year=temp.getFullYear();}
if(expression&&this.weekday&&this.unit!="month"){this.unit="day";gap=($D.getDayNumberFromName(this.weekday)-today.getDay());mod=7;this.days=gap?((gap+(orient*mod))%mod):(orient*mod);}
if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null;}
if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1;}
if(this.month&&!this.day&&this.value){today.set({day:this.value*1});if(!expression){this.day=this.value*1;}}
if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;expression=true;}
if(expression&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";gap=(this.month-today.getMonth());mod=12;this.months=gap?((gap+(orient*mod))%mod):(orient*mod);this.month=null;}
if(!this.unit){this.unit="day";}
if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*orient;}else if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1;}
this[this.unit+"s"]=this.value*orient;}
if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12;}else if(this.meridian=="a"&&this.hour==12){this.hour=0;}}
if(this.weekday&&!this.day&&!this.days){var temp=Date[this.weekday]();this.day=temp.getDate();if(temp.getMonth()!==today.getMonth()){this.month=temp.getMonth();}}
if((this.month||this.month===0)&&!this.day){this.day=1;}
if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value);}
if(expression&&this.timezone&&this.day&&this.days){this.day=this.days;}
return(expression)?today.add(this):today.set(this);}};var _=$D.Parsing.Operators,g=$D.Grammar,t=$D.Translator,_fn;g.datePartDelimiter=_.rtoken(/^([\s\-\.\,\/\x27]+)/);g.timePartDelimiter=_.stoken(":");g.whiteSpace=_.rtoken(/^\s*/);g.generalDelimiter=_.rtoken(/^(([\s\,]|at|@|on)+)/);var _C={};g.ctoken=function(keys){var fn=_C[keys];if(!fn){var c=$C.regexPatterns;var kx=keys.split(/\s+/),px=[];for(var i=0;i<kx.length;i++){px.push(_.replace(_.rtoken(c[kx[i]]),kx[i]));}
fn=_C[keys]=_.any.apply(null,px);}
return fn;};g.ctoken2=function(key){return _.rtoken($C.regexPatterns[key]);};g.h=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),t.hour));g.hh=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2])/),t.hour));g.H=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),t.hour));g.HH=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3])/),t.hour));g.m=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.minute));g.mm=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.minute));g.s=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.second));g.ss=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.second));g.hms=_.cache(_.sequence([g.H,g.m,g.s],g.timePartDelimiter));g.t=_.cache(_.process(g.ctoken2("shortMeridian"),t.meridian));g.tt=_.cache(_.process(g.ctoken2("longMeridian"),t.meridian));g.z=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),t.timezone));g.zz=_.cache(_.process(_.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),t.timezone));g.zzz=_.cache(_.process(g.ctoken2("timezone"),t.timezone));g.timeSuffix=_.each(_.ignore(g.whiteSpace),_.set([g.tt,g.zzz]));g.time=_.each(_.optional(_.ignore(_.stoken("T"))),g.hms,g.timeSuffix);g.d=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1]|\d)/),_.optional(g.ctoken2("ordinalSuffix"))),t.day));g.dd=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1])/),_.optional(g.ctoken2("ordinalSuffix"))),t.day));g.ddd=g.dddd=_.cache(_.process(g.ctoken("sun mon tue wed thu fri sat"),function(s){return function(){this.weekday=s;};}));g.M=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d|\d)/),t.month));g.MM=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d)/),t.month));g.MMM=g.MMMM=_.cache(_.process(g.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),t.month));g.y=_.cache(_.process(_.rtoken(/^(\d\d?)/),t.year));g.yy=_.cache(_.process(_.rtoken(/^(\d\d)/),t.year));g.yyy=_.cache(_.process(_.rtoken(/^(\d\d?\d?\d?)/),t.year));g.yyyy=_.cache(_.process(_.rtoken(/^(\d\d\d\d)/),t.year));_fn=function(){return _.each(_.any.apply(null,arguments),_.not(g.ctoken2("timeContext")));};g.day=_fn(g.d,g.dd);g.month=_fn(g.M,g.MMM);g.year=_fn(g.yyyy,g.yy);g.orientation=_.process(g.ctoken("past future"),function(s){return function(){this.orient=s;};});g.operator=_.process(g.ctoken("add subtract"),function(s){return function(){this.operator=s;};});g.rday=_.process(g.ctoken("yesterday tomorrow today now"),t.rday);g.unit=_.process(g.ctoken("second minute hour day week month year"),function(s){return function(){this.unit=s;};});g.value=_.process(_.rtoken(/^\d\d?(st|nd|rd|th)?/),function(s){return function(){this.value=s.replace(/\D/g,"");};});g.expression=_.set([g.rday,g.operator,g.value,g.unit,g.orientation,g.ddd,g.MMM]);_fn=function(){return _.set(arguments,g.datePartDelimiter);};g.mdy=_fn(g.ddd,g.month,g.day,g.year);g.ymd=_fn(g.ddd,g.year,g.month,g.day);g.dmy=_fn(g.ddd,g.day,g.month,g.year);g.date=function(s){return((g[$C.dateElementOrder]||g.mdy).call(this,s));};g.format=_.process(_.many(_.any(_.process(_.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(fmt){if(g[fmt]){return g[fmt];}else{throw $D.Parsing.Exception(fmt);}}),_.process(_.rtoken(/^[^dMyhHmstz]+/),function(s){return _.ignore(_.stoken(s));}))),function(rules){return _.process(_.each.apply(null,rules),t.finishExact);});var _F={};var _get=function(f){return _F[f]=(_F[f]||g.format(f)[0]);};g.formats=function(fx){if(fx instanceof Array){var rx=[];for(var i=0;i<fx.length;i++){rx.push(_get(fx[i]));}
return _.any.apply(null,rx);}else{return _get(fx);}};g._formats=g.formats(["\"yyyy-MM-ddTHH:mm:ssZ\"","yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);g._start=_.process(_.set([g.date,g.time,g.expression],g.generalDelimiter,g.whiteSpace),t.finish);g.start=function(s){try{var r=g._formats.call({},s);if(r[1].length===0){return r;}}catch(e){}
return g._start.call({},s);};$D._parse=$D.parse;$D.parse=function(s){var r=null;if(!s){return null;}
if(s instanceof Date){return s;}
try{r=$D.Grammar.start.call({},s.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"));}catch(e){return null;}
return((r[1].length===0)?r[0]:null);};$D.getParseFunction=function(fx){var fn=$D.Grammar.formats(fx);return function(s){var r=null;try{r=fn.call({},s);}catch(e){return null;}
return((r[1].length===0)?r[0]:null);};};$D.parseExact=function(s,fx){return $D.getParseFunction(fx)(s);};}());

},{}],2:[function(require,module,exports){
///<reference path="../node_modules/backbone-typings/backbone.d.ts"/>
"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var CategoryCount = (function () {
    function CategoryCount() {
    }
    return CategoryCount;
}());
var CategoryView = (function (_super) {
    __extends(CategoryView, _super);
    function CategoryView(options) {
        _super.call(this, options);
        this.categoryCount = [];
        this.template = _.template($('#categoryTemplate').html());
        this.setElement($('#categories'));
        this.categoryCount = [];
    }
    CategoryView.prototype.render = function () {
        var _this = this;
        var content = [];
        var sum = _.reduce(this.categoryCount, function (memo, item) {
            // only expenses
            if (item.catName != 'Default' && item.amount < 0) {
                return memo + item.amount;
            }
            else {
                return memo;
            }
        }, 0);
        console.log('sum', sum);
        this.categoryCount = _.sortBy(this.categoryCount, function (el) {
            return -el.amount;
        }).reverse();
        _.each(this.categoryCount, function (catCount) {
            if (catCount.catName != 'Default' && catCount.amount < 0) {
                var width = Math.round(100 * (-catCount.amount) / -sum) + '%';
                console.log(catCount.catName, width, catCount.count, catCount.amount);
                content.push(_this.template(_.extend(catCount, {
                    width: width,
                    amount: Math.round(catCount.amount)
                })));
            }
        });
        this.$el.html(content.join('\n'));
        return this;
    };
    CategoryView.prototype.change = function () {
        var _this = this;
        console.log('model changed', this.model.size());
        this.model.each(function (transaction) {
            var categoryName = transaction.get('category');
            var exists = _.findWhere(_this.categoryCount, { catName: categoryName });
            if (exists) {
                exists.count++;
                exists.amount += parseFloat(transaction.get('amount'));
            }
            else {
                _this.categoryCount.push({
                    catName: categoryName,
                    count: 0,
                    amount: 0
                });
            }
        });
        console.log(this.categoryCount);
        this.render();
    };
    return CategoryView;
}(Backbone.View));
exports.__esModule = true;
exports["default"] = CategoryView;

},{}],3:[function(require,module,exports){
/// <reference path="../typings/index.d.ts" />
/// <reference path="../node_modules/backbone-typings/backbone.d.ts" />
/// <reference path="umsaetze.ts" />
/// <reference path="Papa.d.ts" />
"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var umsaetze_1 = require('./umsaetze');
var Transaction_1 = require('./Transaction');
var Expenses = (function (_super) {
    __extends(Expenses, _super);
    function Expenses() {
        _super.apply(this, arguments);
        this.attributes = null;
        this.model = Transaction_1["default"];
        this.csvUrl = '../umsaetze-1090729-2016-07-27-00-11-29.cat.csv';
    }
    Expenses.prototype.fetch = function (options) {
        var _this = this;
        console.log('csvUrl', this.csvUrl);
        return $.get(this.csvUrl, function (response, xhr) {
            var csv = Papa.parse(response, {
                header: true,
                dynamicTyping: true,
                skipEmptyLines: true
            });
            //console.log(csv);
            if (false) {
                _.each(csv.data, _this.processRow.bind(_this));
                _this.processDone(csv.data.length, options);
            }
            else {
                umsaetze_1.asyncLoop(csv.data, _this.processRow.bind(_this), _this.processDone.bind(_this, options));
            }
        });
    };
    Expenses.prototype.processRow = function (row, i, length) {
        var percent = Math.round(100 * i / length);
        //console.log(row);
        $('.progress .progress-bar').width(percent + '%');
        this.add(new Transaction_1["default"](row));
        //this.trigger('change');
    };
    Expenses.prototype.processDone = function (count, options) {
        console.log('asyncLoop finished', count);
        if (options.success) {
            options.success.call();
        }
        this.trigger('change');
    };
    Expenses.prototype.getDateFrom = function () {
        var min = new Date().valueOf();
        this.each(function (row) {
            var date = Date.parse(row.get('date'));
            if (date < min) {
                min = date;
            }
        });
        return new Date(min);
    };
    Expenses.prototype.getDateTill = function () {
        var min = new Date('1970-01-01').valueOf();
        this.each(function (row) {
            var date = Date.parse(row.get('date'));
            if (date > min) {
                min = date;
            }
        });
        return new Date(min);
    };
    return Expenses;
}(Backbone.Collection));
exports.__esModule = true;
exports["default"] = Expenses;

},{"./Transaction":4,"./umsaetze":5}],4:[function(require,module,exports){
///<reference path="../node_modules/backbone-typings/backbone.d.ts"/>
"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var Transaction = (function (_super) {
    __extends(Transaction, _super);
    function Transaction() {
        _super.apply(this, arguments);
    }
    Transaction.prototype.sign = function () {
        return this.amount >= 0 ? 'positive' : 'negative';
    };
    Transaction.prototype.toJSON = function () {
        var json = _super.prototype.toJSON.call(this);
        json.sign = this.sign();
        return json;
    };
    return Transaction;
}(Backbone.Model));
exports.__esModule = true;
exports["default"] = Transaction;

},{}],5:[function(require,module,exports){
/// <reference path="../typings/index.d.ts" />
/// <reference path="../node_modules/backbone-typings/backbone.d.ts" />
/// <reference path="Expenses.ts" />
"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
function asyncLoop(arr, callback, done) {
    (function loop(i) {
        callback(arr[i], i, arr.length); //callback when the loop goes on
        if (i < arr.length) {
            setTimeout(function () { loop(++i); }, 1); //rerun when condition is true
        }
        else {
            if (done) {
                done(arr.length); //callback when the loop ends
            }
        }
    }(0)); //start with 0
}
exports.asyncLoop = asyncLoop;
var Expenses_1 = require('./Expenses');
require('datejs');
var ExpenseTable = (function (_super) {
    __extends(ExpenseTable, _super);
    function ExpenseTable(options) {
        _super.call(this, options);
        /**
         * Too early, wait until initialize()
         * @type {JQuery}
         */
        //el = $('#expenseTable');
        this.template = _.template($('#rowTemplate').html());
        this.setElement($('#expenseTable'));
        this.listenTo(this.model, 'change', this.render);
    }
    ExpenseTable.prototype.render = function () {
        var _this = this;
        console.log('ExpenseTable.render()', this.model.size());
        console.log(this.model);
        var rows = [];
        this.model.each(function (transaction) {
            //console.log(transaction);
            var attributes = transaction.toJSON();
            if (attributes.hasOwnProperty('date')) {
                rows.push(_this.template(attributes));
            }
            else {
                console.log('no date', attributes);
            }
        });
        console.log('rendering', rows.length, 'rows');
        this.$el.append(rows.join('\n'));
        //console.log(this.$el);
        $('#dateFrom').html(this.model.getDateFrom().toString('yyyy-MM-dd'));
        $('#dateTill').html(this.model.getDateTill().toString('yyyy-MM-dd'));
        return this;
    };
    return ExpenseTable;
}(Backbone.View));
var CategoryView_1 = require('./CategoryView');
var AppView = (function (_super) {
    __extends(AppView, _super);
    function AppView(options) {
        var _this = this;
        _super.call(this, options);
        console.log('construct AppView');
        this.setElement($('#app'));
        this.model = new Expenses_1["default"]();
        this.table = new ExpenseTable({
            model: this.model,
            el: $('#expenseTable')
        });
        this.categories = new CategoryView_1["default"]({
            model: this.model
        });
        this.startLoading();
        this.model.fetch({
            success: function () {
                _this.stopLoading();
            }
        });
        this.listenTo(this.model, "change", this.render.bind(this));
        this.listenTo(this.model, "change", this.categories.change.bind(this.categories));
    }
    AppView.prototype.startLoading = function () {
        console.log('startLoading');
        var template = _.template($('#loadingBar').html());
        this.$el.html(template());
    };
    AppView.prototype.stopLoading = function () {
        console.log('stopLoading');
        this.$el.html('Done');
    };
    AppView.prototype.render = function () {
        console.log('AppView.render()', this.model);
        if (this.model && this.model.size()) {
            this.table.render();
            this.$el.html('Table shown');
        }
        else {
            this.startLoading();
        }
        return this;
    };
    return AppView;
}(Backbone.View));
$(function () {
    var app = new AppView();
    app.render();
});

},{"./CategoryView":2,"./Expenses":3,"datejs":1}]},{},[5])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvZGF0ZWpzL2xpYi9kYXRlLmpzIiwic3JjL0NhdGVnb3J5Vmlldy5qcyIsInNyYy9FeHBlbnNlcy5qcyIsInNyYy9UcmFuc2FjdGlvbi5qcyIsInNyYy91bXNhZXR6ZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqXHJcbiAqIEB2ZXJzaW9uOiAxLjAgQWxwaGEtMVxyXG4gKiBAYXV0aG9yOiBDb29saXRlIEluYy4gaHR0cDovL3d3dy5jb29saXRlLmNvbS9cclxuICogQGRhdGU6IDIwMDgtMDUtMTNcclxuICogQGNvcHlyaWdodDogQ29weXJpZ2h0IChjKSAyMDA2LTIwMDgsIENvb2xpdGUgSW5jLiAoaHR0cDovL3d3dy5jb29saXRlLmNvbS8pLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiBAbGljZW5zZTogTGljZW5zZWQgdW5kZXIgVGhlIE1JVCBMaWNlbnNlLiBTZWUgbGljZW5zZS50eHQgYW5kIGh0dHA6Ly93d3cuZGF0ZWpzLmNvbS9saWNlbnNlLy4gXHJcbiAqIEB3ZWJzaXRlOiBodHRwOi8vd3d3LmRhdGVqcy5jb20vXHJcbiAqL1xyXG5EYXRlLkN1bHR1cmVJbmZvPXtuYW1lOlwiZW4tVVNcIixlbmdsaXNoTmFtZTpcIkVuZ2xpc2ggKFVuaXRlZCBTdGF0ZXMpXCIsbmF0aXZlTmFtZTpcIkVuZ2xpc2ggKFVuaXRlZCBTdGF0ZXMpXCIsZGF5TmFtZXM6W1wiU3VuZGF5XCIsXCJNb25kYXlcIixcIlR1ZXNkYXlcIixcIldlZG5lc2RheVwiLFwiVGh1cnNkYXlcIixcIkZyaWRheVwiLFwiU2F0dXJkYXlcIl0sYWJicmV2aWF0ZWREYXlOYW1lczpbXCJTdW5cIixcIk1vblwiLFwiVHVlXCIsXCJXZWRcIixcIlRodVwiLFwiRnJpXCIsXCJTYXRcIl0sc2hvcnRlc3REYXlOYW1lczpbXCJTdVwiLFwiTW9cIixcIlR1XCIsXCJXZVwiLFwiVGhcIixcIkZyXCIsXCJTYVwiXSxmaXJzdExldHRlckRheU5hbWVzOltcIlNcIixcIk1cIixcIlRcIixcIldcIixcIlRcIixcIkZcIixcIlNcIl0sbW9udGhOYW1lczpbXCJKYW51YXJ5XCIsXCJGZWJydWFyeVwiLFwiTWFyY2hcIixcIkFwcmlsXCIsXCJNYXlcIixcIkp1bmVcIixcIkp1bHlcIixcIkF1Z3VzdFwiLFwiU2VwdGVtYmVyXCIsXCJPY3RvYmVyXCIsXCJOb3ZlbWJlclwiLFwiRGVjZW1iZXJcIl0sYWJicmV2aWF0ZWRNb250aE5hbWVzOltcIkphblwiLFwiRmViXCIsXCJNYXJcIixcIkFwclwiLFwiTWF5XCIsXCJKdW5cIixcIkp1bFwiLFwiQXVnXCIsXCJTZXBcIixcIk9jdFwiLFwiTm92XCIsXCJEZWNcIl0sYW1EZXNpZ25hdG9yOlwiQU1cIixwbURlc2lnbmF0b3I6XCJQTVwiLGZpcnN0RGF5T2ZXZWVrOjAsdHdvRGlnaXRZZWFyTWF4OjIwMjksZGF0ZUVsZW1lbnRPcmRlcjpcIm1keVwiLGZvcm1hdFBhdHRlcm5zOntzaG9ydERhdGU6XCJNL2QveXl5eVwiLGxvbmdEYXRlOlwiZGRkZCwgTU1NTSBkZCwgeXl5eVwiLHNob3J0VGltZTpcImg6bW0gdHRcIixsb25nVGltZTpcImg6bW06c3MgdHRcIixmdWxsRGF0ZVRpbWU6XCJkZGRkLCBNTU1NIGRkLCB5eXl5IGg6bW06c3MgdHRcIixzb3J0YWJsZURhdGVUaW1lOlwieXl5eS1NTS1kZFRISDptbTpzc1wiLHVuaXZlcnNhbFNvcnRhYmxlRGF0ZVRpbWU6XCJ5eXl5LU1NLWRkIEhIOm1tOnNzWlwiLHJmYzExMjM6XCJkZGQsIGRkIE1NTSB5eXl5IEhIOm1tOnNzIEdNVFwiLG1vbnRoRGF5OlwiTU1NTSBkZFwiLHllYXJNb250aDpcIk1NTU0sIHl5eXlcIn0scmVnZXhQYXR0ZXJuczp7amFuOi9eamFuKHVhcnkpPy9pLGZlYjovXmZlYihydWFyeSk/L2ksbWFyOi9ebWFyKGNoKT8vaSxhcHI6L15hcHIoaWwpPy9pLG1heTovXm1heS9pLGp1bjovXmp1bihlKT8vaSxqdWw6L15qdWwoeSk/L2ksYXVnOi9eYXVnKHVzdCk/L2ksc2VwOi9ec2VwKHQoZW1iZXIpPyk/L2ksb2N0Oi9eb2N0KG9iZXIpPy9pLG5vdjovXm5vdihlbWJlcik/L2ksZGVjOi9eZGVjKGVtYmVyKT8vaSxzdW46L15zdShuKGRheSk/KT8vaSxtb246L15tbyhuKGRheSk/KT8vaSx0dWU6L150dShlKHMoZGF5KT8pPyk/L2ksd2VkOi9ed2UoZChuZXNkYXkpPyk/L2ksdGh1Oi9edGgodShyKHMoZGF5KT8pPyk/KT8vaSxmcmk6L15mcihpKGRheSk/KT8vaSxzYXQ6L15zYSh0KHVyZGF5KT8pPy9pLGZ1dHVyZTovXm5leHQvaSxwYXN0Oi9ebGFzdHxwYXN0fHByZXYoaW91cyk/L2ksYWRkOi9eKFxcK3xhZnQoZXIpP3xmcm9tfGhlbmNlKS9pLHN1YnRyYWN0Oi9eKFxcLXxiZWYob3JlKT98YWdvKS9pLHllc3RlcmRheTovXnllcyh0ZXJkYXkpPy9pLHRvZGF5Oi9edChvZChheSk/KT8vaSx0b21vcnJvdzovXnRvbShvcnJvdyk/L2ksbm93Oi9ebihvdyk/L2ksbWlsbGlzZWNvbmQ6L15tc3xtaWxsaShzZWNvbmQpP3M/L2ksc2Vjb25kOi9ec2VjKG9uZCk/cz8vaSxtaW51dGU6L15tbnxtaW4odXRlKT9zPy9pLGhvdXI6L15oKG91cik/cz8vaSx3ZWVrOi9edyhlZWspP3M/L2ksbW9udGg6L15tKG9udGgpP3M/L2ksZGF5Oi9eZChheSk/cz8vaSx5ZWFyOi9eeShlYXIpP3M/L2ksc2hvcnRNZXJpZGlhbjovXihhfHApL2ksbG9uZ01lcmlkaWFuOi9eKGFcXC4/bT9cXC4/fHBcXC4/bT9cXC4/KS9pLHRpbWV6b25lOi9eKChlKHN8ZCl0fGMoc3xkKXR8bShzfGQpdHxwKHN8ZCl0KXwoKGdtdCk/XFxzKihcXCt8XFwtKVxccypcXGRcXGRcXGRcXGQ/KXxnbXR8dXRjKS9pLG9yZGluYWxTdWZmaXg6L15cXHMqKHN0fG5kfHJkfHRoKS9pLHRpbWVDb250ZXh0Oi9eXFxzKihcXDp8YSg/IXV8cCl8cCkvaX0sdGltZXpvbmVzOlt7bmFtZTpcIlVUQ1wiLG9mZnNldDpcIi0wMDBcIn0se25hbWU6XCJHTVRcIixvZmZzZXQ6XCItMDAwXCJ9LHtuYW1lOlwiRVNUXCIsb2Zmc2V0OlwiLTA1MDBcIn0se25hbWU6XCJFRFRcIixvZmZzZXQ6XCItMDQwMFwifSx7bmFtZTpcIkNTVFwiLG9mZnNldDpcIi0wNjAwXCJ9LHtuYW1lOlwiQ0RUXCIsb2Zmc2V0OlwiLTA1MDBcIn0se25hbWU6XCJNU1RcIixvZmZzZXQ6XCItMDcwMFwifSx7bmFtZTpcIk1EVFwiLG9mZnNldDpcIi0wNjAwXCJ9LHtuYW1lOlwiUFNUXCIsb2Zmc2V0OlwiLTA4MDBcIn0se25hbWU6XCJQRFRcIixvZmZzZXQ6XCItMDcwMFwifV19O1xuKGZ1bmN0aW9uKCl7dmFyICREPURhdGUsJFA9JEQucHJvdG90eXBlLCRDPSRELkN1bHR1cmVJbmZvLHA9ZnVuY3Rpb24ocyxsKXtpZighbCl7bD0yO31cbnJldHVybihcIjAwMFwiK3MpLnNsaWNlKGwqLTEpO307JFAuY2xlYXJUaW1lPWZ1bmN0aW9uKCl7dGhpcy5zZXRIb3VycygwKTt0aGlzLnNldE1pbnV0ZXMoMCk7dGhpcy5zZXRTZWNvbmRzKDApO3RoaXMuc2V0TWlsbGlzZWNvbmRzKDApO3JldHVybiB0aGlzO307JFAuc2V0VGltZVRvTm93PWZ1bmN0aW9uKCl7dmFyIG49bmV3IERhdGUoKTt0aGlzLnNldEhvdXJzKG4uZ2V0SG91cnMoKSk7dGhpcy5zZXRNaW51dGVzKG4uZ2V0TWludXRlcygpKTt0aGlzLnNldFNlY29uZHMobi5nZXRTZWNvbmRzKCkpO3RoaXMuc2V0TWlsbGlzZWNvbmRzKG4uZ2V0TWlsbGlzZWNvbmRzKCkpO3JldHVybiB0aGlzO307JEQudG9kYXk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IERhdGUoKS5jbGVhclRpbWUoKTt9OyRELmNvbXBhcmU9ZnVuY3Rpb24oZGF0ZTEsZGF0ZTIpe2lmKGlzTmFOKGRhdGUxKXx8aXNOYU4oZGF0ZTIpKXt0aHJvdyBuZXcgRXJyb3IoZGF0ZTErXCIgLSBcIitkYXRlMik7fWVsc2UgaWYoZGF0ZTEgaW5zdGFuY2VvZiBEYXRlJiZkYXRlMiBpbnN0YW5jZW9mIERhdGUpe3JldHVybihkYXRlMTxkYXRlMik/LTE6KGRhdGUxPmRhdGUyKT8xOjA7fWVsc2V7dGhyb3cgbmV3IFR5cGVFcnJvcihkYXRlMStcIiAtIFwiK2RhdGUyKTt9fTskRC5lcXVhbHM9ZnVuY3Rpb24oZGF0ZTEsZGF0ZTIpe3JldHVybihkYXRlMS5jb21wYXJlVG8oZGF0ZTIpPT09MCk7fTskRC5nZXREYXlOdW1iZXJGcm9tTmFtZT1mdW5jdGlvbihuYW1lKXt2YXIgbj0kQy5kYXlOYW1lcyxtPSRDLmFiYnJldmlhdGVkRGF5TmFtZXMsbz0kQy5zaG9ydGVzdERheU5hbWVzLHM9bmFtZS50b0xvd2VyQ2FzZSgpO2Zvcih2YXIgaT0wO2k8bi5sZW5ndGg7aSsrKXtpZihuW2ldLnRvTG93ZXJDYXNlKCk9PXN8fG1baV0udG9Mb3dlckNhc2UoKT09c3x8b1tpXS50b0xvd2VyQ2FzZSgpPT1zKXtyZXR1cm4gaTt9fVxucmV0dXJuLTE7fTskRC5nZXRNb250aE51bWJlckZyb21OYW1lPWZ1bmN0aW9uKG5hbWUpe3ZhciBuPSRDLm1vbnRoTmFtZXMsbT0kQy5hYmJyZXZpYXRlZE1vbnRoTmFtZXMscz1uYW1lLnRvTG93ZXJDYXNlKCk7Zm9yKHZhciBpPTA7aTxuLmxlbmd0aDtpKyspe2lmKG5baV0udG9Mb3dlckNhc2UoKT09c3x8bVtpXS50b0xvd2VyQ2FzZSgpPT1zKXtyZXR1cm4gaTt9fVxucmV0dXJuLTE7fTskRC5pc0xlYXBZZWFyPWZ1bmN0aW9uKHllYXIpe3JldHVybigoeWVhciU0PT09MCYmeWVhciUxMDAhPT0wKXx8eWVhciU0MDA9PT0wKTt9OyRELmdldERheXNJbk1vbnRoPWZ1bmN0aW9uKHllYXIsbW9udGgpe3JldHVyblszMSwoJEQuaXNMZWFwWWVhcih5ZWFyKT8yOToyOCksMzEsMzAsMzEsMzAsMzEsMzEsMzAsMzEsMzAsMzFdW21vbnRoXTt9OyRELmdldFRpbWV6b25lQWJicmV2aWF0aW9uPWZ1bmN0aW9uKG9mZnNldCl7dmFyIHo9JEMudGltZXpvbmVzLHA7Zm9yKHZhciBpPTA7aTx6Lmxlbmd0aDtpKyspe2lmKHpbaV0ub2Zmc2V0PT09b2Zmc2V0KXtyZXR1cm4geltpXS5uYW1lO319XG5yZXR1cm4gbnVsbDt9OyRELmdldFRpbWV6b25lT2Zmc2V0PWZ1bmN0aW9uKG5hbWUpe3ZhciB6PSRDLnRpbWV6b25lcyxwO2Zvcih2YXIgaT0wO2k8ei5sZW5ndGg7aSsrKXtpZih6W2ldLm5hbWU9PT1uYW1lLnRvVXBwZXJDYXNlKCkpe3JldHVybiB6W2ldLm9mZnNldDt9fVxucmV0dXJuIG51bGw7fTskUC5jbG9uZT1mdW5jdGlvbigpe3JldHVybiBuZXcgRGF0ZSh0aGlzLmdldFRpbWUoKSk7fTskUC5jb21wYXJlVG89ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIERhdGUuY29tcGFyZSh0aGlzLGRhdGUpO307JFAuZXF1YWxzPWZ1bmN0aW9uKGRhdGUpe3JldHVybiBEYXRlLmVxdWFscyh0aGlzLGRhdGV8fG5ldyBEYXRlKCkpO307JFAuYmV0d2Vlbj1mdW5jdGlvbihzdGFydCxlbmQpe3JldHVybiB0aGlzLmdldFRpbWUoKT49c3RhcnQuZ2V0VGltZSgpJiZ0aGlzLmdldFRpbWUoKTw9ZW5kLmdldFRpbWUoKTt9OyRQLmlzQWZ0ZXI9ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIHRoaXMuY29tcGFyZVRvKGRhdGV8fG5ldyBEYXRlKCkpPT09MTt9OyRQLmlzQmVmb3JlPWZ1bmN0aW9uKGRhdGUpe3JldHVybih0aGlzLmNvbXBhcmVUbyhkYXRlfHxuZXcgRGF0ZSgpKT09PS0xKTt9OyRQLmlzVG9kYXk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc1NhbWVEYXkobmV3IERhdGUoKSk7fTskUC5pc1NhbWVEYXk9ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIHRoaXMuY2xvbmUoKS5jbGVhclRpbWUoKS5lcXVhbHMoZGF0ZS5jbG9uZSgpLmNsZWFyVGltZSgpKTt9OyRQLmFkZE1pbGxpc2Vjb25kcz1mdW5jdGlvbih2YWx1ZSl7dGhpcy5zZXRNaWxsaXNlY29uZHModGhpcy5nZXRNaWxsaXNlY29uZHMoKSt2YWx1ZSk7cmV0dXJuIHRoaXM7fTskUC5hZGRTZWNvbmRzPWZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdGhpcy5hZGRNaWxsaXNlY29uZHModmFsdWUqMTAwMCk7fTskUC5hZGRNaW51dGVzPWZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gdGhpcy5hZGRNaWxsaXNlY29uZHModmFsdWUqNjAwMDApO307JFAuYWRkSG91cnM9ZnVuY3Rpb24odmFsdWUpe3JldHVybiB0aGlzLmFkZE1pbGxpc2Vjb25kcyh2YWx1ZSozNjAwMDAwKTt9OyRQLmFkZERheXM9ZnVuY3Rpb24odmFsdWUpe3RoaXMuc2V0RGF0ZSh0aGlzLmdldERhdGUoKSt2YWx1ZSk7cmV0dXJuIHRoaXM7fTskUC5hZGRXZWVrcz1mdW5jdGlvbih2YWx1ZSl7cmV0dXJuIHRoaXMuYWRkRGF5cyh2YWx1ZSo3KTt9OyRQLmFkZE1vbnRocz1mdW5jdGlvbih2YWx1ZSl7dmFyIG49dGhpcy5nZXREYXRlKCk7dGhpcy5zZXREYXRlKDEpO3RoaXMuc2V0TW9udGgodGhpcy5nZXRNb250aCgpK3ZhbHVlKTt0aGlzLnNldERhdGUoTWF0aC5taW4obiwkRC5nZXREYXlzSW5Nb250aCh0aGlzLmdldEZ1bGxZZWFyKCksdGhpcy5nZXRNb250aCgpKSkpO3JldHVybiB0aGlzO307JFAuYWRkWWVhcnM9ZnVuY3Rpb24odmFsdWUpe3JldHVybiB0aGlzLmFkZE1vbnRocyh2YWx1ZSoxMik7fTskUC5hZGQ9ZnVuY3Rpb24oY29uZmlnKXtpZih0eXBlb2YgY29uZmlnPT1cIm51bWJlclwiKXt0aGlzLl9vcmllbnQ9Y29uZmlnO3JldHVybiB0aGlzO31cbnZhciB4PWNvbmZpZztpZih4Lm1pbGxpc2Vjb25kcyl7dGhpcy5hZGRNaWxsaXNlY29uZHMoeC5taWxsaXNlY29uZHMpO31cbmlmKHguc2Vjb25kcyl7dGhpcy5hZGRTZWNvbmRzKHguc2Vjb25kcyk7fVxuaWYoeC5taW51dGVzKXt0aGlzLmFkZE1pbnV0ZXMoeC5taW51dGVzKTt9XG5pZih4LmhvdXJzKXt0aGlzLmFkZEhvdXJzKHguaG91cnMpO31cbmlmKHgud2Vla3Mpe3RoaXMuYWRkV2Vla3MoeC53ZWVrcyk7fVxuaWYoeC5tb250aHMpe3RoaXMuYWRkTW9udGhzKHgubW9udGhzKTt9XG5pZih4LnllYXJzKXt0aGlzLmFkZFllYXJzKHgueWVhcnMpO31cbmlmKHguZGF5cyl7dGhpcy5hZGREYXlzKHguZGF5cyk7fVxucmV0dXJuIHRoaXM7fTt2YXIgJHksJG0sJGQ7JFAuZ2V0V2Vlaz1mdW5jdGlvbigpe3ZhciBhLGIsYyxkLGUsZixnLG4scyx3OyR5PSghJHkpP3RoaXMuZ2V0RnVsbFllYXIoKTokeTskbT0oISRtKT90aGlzLmdldE1vbnRoKCkrMTokbTskZD0oISRkKT90aGlzLmdldERhdGUoKTokZDtpZigkbTw9Mil7YT0keS0xO2I9KGEvNHwwKS0oYS8xMDB8MCkrKGEvNDAwfDApO2M9KChhLTEpLzR8MCktKChhLTEpLzEwMHwwKSsoKGEtMSkvNDAwfDApO3M9Yi1jO2U9MDtmPSRkLTErKDMxKigkbS0xKSk7fWVsc2V7YT0keTtiPShhLzR8MCktKGEvMTAwfDApKyhhLzQwMHwwKTtjPSgoYS0xKS80fDApLSgoYS0xKS8xMDB8MCkrKChhLTEpLzQwMHwwKTtzPWItYztlPXMrMTtmPSRkKygoMTUzKigkbS0zKSsyKS81KSs1OCtzO31cbmc9KGErYiklNztkPShmK2ctZSklNztuPShmKzMtZCl8MDtpZihuPDApe3c9NTMtKChnLXMpLzV8MCk7fWVsc2UgaWYobj4zNjQrcyl7dz0xO31lbHNle3c9KG4vN3wwKSsxO31cbiR5PSRtPSRkPW51bGw7cmV0dXJuIHc7fTskUC5nZXRJU09XZWVrPWZ1bmN0aW9uKCl7JHk9dGhpcy5nZXRVVENGdWxsWWVhcigpOyRtPXRoaXMuZ2V0VVRDTW9udGgoKSsxOyRkPXRoaXMuZ2V0VVRDRGF0ZSgpO3JldHVybiBwKHRoaXMuZ2V0V2VlaygpKTt9OyRQLnNldFdlZWs9ZnVuY3Rpb24obil7cmV0dXJuIHRoaXMubW92ZVRvRGF5T2ZXZWVrKDEpLmFkZFdlZWtzKG4tdGhpcy5nZXRXZWVrKCkpO307JEQuX3ZhbGlkYXRlPWZ1bmN0aW9uKG4sbWluLG1heCxuYW1lKXtpZih0eXBlb2Ygbj09XCJ1bmRlZmluZWRcIil7cmV0dXJuIGZhbHNlO31lbHNlIGlmKHR5cGVvZiBuIT1cIm51bWJlclwiKXt0aHJvdyBuZXcgVHlwZUVycm9yKG4rXCIgaXMgbm90IGEgTnVtYmVyLlwiKTt9ZWxzZSBpZihuPG1pbnx8bj5tYXgpe3Rocm93IG5ldyBSYW5nZUVycm9yKG4rXCIgaXMgbm90IGEgdmFsaWQgdmFsdWUgZm9yIFwiK25hbWUrXCIuXCIpO31cbnJldHVybiB0cnVlO307JEQudmFsaWRhdGVNaWxsaXNlY29uZD1mdW5jdGlvbih2YWx1ZSl7cmV0dXJuICRELl92YWxpZGF0ZSh2YWx1ZSwwLDk5OSxcIm1pbGxpc2Vjb25kXCIpO307JEQudmFsaWRhdGVTZWNvbmQ9ZnVuY3Rpb24odmFsdWUpe3JldHVybiAkRC5fdmFsaWRhdGUodmFsdWUsMCw1OSxcInNlY29uZFwiKTt9OyRELnZhbGlkYXRlTWludXRlPWZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gJEQuX3ZhbGlkYXRlKHZhbHVlLDAsNTksXCJtaW51dGVcIik7fTskRC52YWxpZGF0ZUhvdXI9ZnVuY3Rpb24odmFsdWUpe3JldHVybiAkRC5fdmFsaWRhdGUodmFsdWUsMCwyMyxcImhvdXJcIik7fTskRC52YWxpZGF0ZURheT1mdW5jdGlvbih2YWx1ZSx5ZWFyLG1vbnRoKXtyZXR1cm4gJEQuX3ZhbGlkYXRlKHZhbHVlLDEsJEQuZ2V0RGF5c0luTW9udGgoeWVhcixtb250aCksXCJkYXlcIik7fTskRC52YWxpZGF0ZU1vbnRoPWZ1bmN0aW9uKHZhbHVlKXtyZXR1cm4gJEQuX3ZhbGlkYXRlKHZhbHVlLDAsMTEsXCJtb250aFwiKTt9OyRELnZhbGlkYXRlWWVhcj1mdW5jdGlvbih2YWx1ZSl7cmV0dXJuICRELl92YWxpZGF0ZSh2YWx1ZSwwLDk5OTksXCJ5ZWFyXCIpO307JFAuc2V0PWZ1bmN0aW9uKGNvbmZpZyl7aWYoJEQudmFsaWRhdGVNaWxsaXNlY29uZChjb25maWcubWlsbGlzZWNvbmQpKXt0aGlzLmFkZE1pbGxpc2Vjb25kcyhjb25maWcubWlsbGlzZWNvbmQtdGhpcy5nZXRNaWxsaXNlY29uZHMoKSk7fVxuaWYoJEQudmFsaWRhdGVTZWNvbmQoY29uZmlnLnNlY29uZCkpe3RoaXMuYWRkU2Vjb25kcyhjb25maWcuc2Vjb25kLXRoaXMuZ2V0U2Vjb25kcygpKTt9XG5pZigkRC52YWxpZGF0ZU1pbnV0ZShjb25maWcubWludXRlKSl7dGhpcy5hZGRNaW51dGVzKGNvbmZpZy5taW51dGUtdGhpcy5nZXRNaW51dGVzKCkpO31cbmlmKCRELnZhbGlkYXRlSG91cihjb25maWcuaG91cikpe3RoaXMuYWRkSG91cnMoY29uZmlnLmhvdXItdGhpcy5nZXRIb3VycygpKTt9XG5pZigkRC52YWxpZGF0ZU1vbnRoKGNvbmZpZy5tb250aCkpe3RoaXMuYWRkTW9udGhzKGNvbmZpZy5tb250aC10aGlzLmdldE1vbnRoKCkpO31cbmlmKCRELnZhbGlkYXRlWWVhcihjb25maWcueWVhcikpe3RoaXMuYWRkWWVhcnMoY29uZmlnLnllYXItdGhpcy5nZXRGdWxsWWVhcigpKTt9XG5pZigkRC52YWxpZGF0ZURheShjb25maWcuZGF5LHRoaXMuZ2V0RnVsbFllYXIoKSx0aGlzLmdldE1vbnRoKCkpKXt0aGlzLmFkZERheXMoY29uZmlnLmRheS10aGlzLmdldERhdGUoKSk7fVxuaWYoY29uZmlnLnRpbWV6b25lKXt0aGlzLnNldFRpbWV6b25lKGNvbmZpZy50aW1lem9uZSk7fVxuaWYoY29uZmlnLnRpbWV6b25lT2Zmc2V0KXt0aGlzLnNldFRpbWV6b25lT2Zmc2V0KGNvbmZpZy50aW1lem9uZU9mZnNldCk7fVxuaWYoY29uZmlnLndlZWsmJiRELl92YWxpZGF0ZShjb25maWcud2VlaywwLDUzLFwid2Vla1wiKSl7dGhpcy5zZXRXZWVrKGNvbmZpZy53ZWVrKTt9XG5yZXR1cm4gdGhpczt9OyRQLm1vdmVUb0ZpcnN0RGF5T2ZNb250aD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNldCh7ZGF5OjF9KTt9OyRQLm1vdmVUb0xhc3REYXlPZk1vbnRoPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc2V0KHtkYXk6JEQuZ2V0RGF5c0luTW9udGgodGhpcy5nZXRGdWxsWWVhcigpLHRoaXMuZ2V0TW9udGgoKSl9KTt9OyRQLm1vdmVUb050aE9jY3VycmVuY2U9ZnVuY3Rpb24oZGF5T2ZXZWVrLG9jY3VycmVuY2Upe3ZhciBzaGlmdD0wO2lmKG9jY3VycmVuY2U+MCl7c2hpZnQ9b2NjdXJyZW5jZS0xO31cbmVsc2UgaWYob2NjdXJyZW5jZT09PS0xKXt0aGlzLm1vdmVUb0xhc3REYXlPZk1vbnRoKCk7aWYodGhpcy5nZXREYXkoKSE9PWRheU9mV2Vlayl7dGhpcy5tb3ZlVG9EYXlPZldlZWsoZGF5T2ZXZWVrLC0xKTt9XG5yZXR1cm4gdGhpczt9XG5yZXR1cm4gdGhpcy5tb3ZlVG9GaXJzdERheU9mTW9udGgoKS5hZGREYXlzKC0xKS5tb3ZlVG9EYXlPZldlZWsoZGF5T2ZXZWVrLCsxKS5hZGRXZWVrcyhzaGlmdCk7fTskUC5tb3ZlVG9EYXlPZldlZWs9ZnVuY3Rpb24oZGF5T2ZXZWVrLG9yaWVudCl7dmFyIGRpZmY9KGRheU9mV2Vlay10aGlzLmdldERheSgpKzcqKG9yaWVudHx8KzEpKSU3O3JldHVybiB0aGlzLmFkZERheXMoKGRpZmY9PT0wKT9kaWZmKz03KihvcmllbnR8fCsxKTpkaWZmKTt9OyRQLm1vdmVUb01vbnRoPWZ1bmN0aW9uKG1vbnRoLG9yaWVudCl7dmFyIGRpZmY9KG1vbnRoLXRoaXMuZ2V0TW9udGgoKSsxMioob3JpZW50fHwrMSkpJTEyO3JldHVybiB0aGlzLmFkZE1vbnRocygoZGlmZj09PTApP2RpZmYrPTEyKihvcmllbnR8fCsxKTpkaWZmKTt9OyRQLmdldE9yZGluYWxOdW1iZXI9ZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5jZWlsKCh0aGlzLmNsb25lKCkuY2xlYXJUaW1lKCktbmV3IERhdGUodGhpcy5nZXRGdWxsWWVhcigpLDAsMSkpLzg2NDAwMDAwKSsxO307JFAuZ2V0VGltZXpvbmU9ZnVuY3Rpb24oKXtyZXR1cm4gJEQuZ2V0VGltZXpvbmVBYmJyZXZpYXRpb24odGhpcy5nZXRVVENPZmZzZXQoKSk7fTskUC5zZXRUaW1lem9uZU9mZnNldD1mdW5jdGlvbihvZmZzZXQpe3ZhciBoZXJlPXRoaXMuZ2V0VGltZXpvbmVPZmZzZXQoKSx0aGVyZT1OdW1iZXIob2Zmc2V0KSotNi8xMDtyZXR1cm4gdGhpcy5hZGRNaW51dGVzKHRoZXJlLWhlcmUpO307JFAuc2V0VGltZXpvbmU9ZnVuY3Rpb24ob2Zmc2V0KXtyZXR1cm4gdGhpcy5zZXRUaW1lem9uZU9mZnNldCgkRC5nZXRUaW1lem9uZU9mZnNldChvZmZzZXQpKTt9OyRQLmhhc0RheWxpZ2h0U2F2aW5nVGltZT1mdW5jdGlvbigpe3JldHVybihEYXRlLnRvZGF5KCkuc2V0KHttb250aDowLGRheToxfSkuZ2V0VGltZXpvbmVPZmZzZXQoKSE9PURhdGUudG9kYXkoKS5zZXQoe21vbnRoOjYsZGF5OjF9KS5nZXRUaW1lem9uZU9mZnNldCgpKTt9OyRQLmlzRGF5bGlnaHRTYXZpbmdUaW1lPWZ1bmN0aW9uKCl7cmV0dXJuKHRoaXMuaGFzRGF5bGlnaHRTYXZpbmdUaW1lKCkmJm5ldyBEYXRlKCkuZ2V0VGltZXpvbmVPZmZzZXQoKT09PURhdGUudG9kYXkoKS5zZXQoe21vbnRoOjYsZGF5OjF9KS5nZXRUaW1lem9uZU9mZnNldCgpKTt9OyRQLmdldFVUQ09mZnNldD1mdW5jdGlvbigpe3ZhciBuPXRoaXMuZ2V0VGltZXpvbmVPZmZzZXQoKSotMTAvNixyO2lmKG48MCl7cj0obi0xMDAwMCkudG9TdHJpbmcoKTtyZXR1cm4gci5jaGFyQXQoMCkrci5zdWJzdHIoMik7fWVsc2V7cj0obisxMDAwMCkudG9TdHJpbmcoKTtyZXR1cm5cIitcIityLnN1YnN0cigxKTt9fTskUC5nZXRFbGFwc2VkPWZ1bmN0aW9uKGRhdGUpe3JldHVybihkYXRlfHxuZXcgRGF0ZSgpKS10aGlzO307aWYoISRQLnRvSVNPU3RyaW5nKXskUC50b0lTT1N0cmluZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGYobil7cmV0dXJuIG48MTA/JzAnK246bjt9XG5yZXR1cm4nXCInK3RoaXMuZ2V0VVRDRnVsbFllYXIoKSsnLScrXG5mKHRoaXMuZ2V0VVRDTW9udGgoKSsxKSsnLScrXG5mKHRoaXMuZ2V0VVRDRGF0ZSgpKSsnVCcrXG5mKHRoaXMuZ2V0VVRDSG91cnMoKSkrJzonK1xuZih0aGlzLmdldFVUQ01pbnV0ZXMoKSkrJzonK1xuZih0aGlzLmdldFVUQ1NlY29uZHMoKSkrJ1pcIic7fTt9XG4kUC5fdG9TdHJpbmc9JFAudG9TdHJpbmc7JFAudG9TdHJpbmc9ZnVuY3Rpb24oZm9ybWF0KXt2YXIgeD10aGlzO2lmKGZvcm1hdCYmZm9ybWF0Lmxlbmd0aD09MSl7dmFyIGM9JEMuZm9ybWF0UGF0dGVybnM7eC50PXgudG9TdHJpbmc7c3dpdGNoKGZvcm1hdCl7Y2FzZVwiZFwiOnJldHVybiB4LnQoYy5zaG9ydERhdGUpO2Nhc2VcIkRcIjpyZXR1cm4geC50KGMubG9uZ0RhdGUpO2Nhc2VcIkZcIjpyZXR1cm4geC50KGMuZnVsbERhdGVUaW1lKTtjYXNlXCJtXCI6cmV0dXJuIHgudChjLm1vbnRoRGF5KTtjYXNlXCJyXCI6cmV0dXJuIHgudChjLnJmYzExMjMpO2Nhc2VcInNcIjpyZXR1cm4geC50KGMuc29ydGFibGVEYXRlVGltZSk7Y2FzZVwidFwiOnJldHVybiB4LnQoYy5zaG9ydFRpbWUpO2Nhc2VcIlRcIjpyZXR1cm4geC50KGMubG9uZ1RpbWUpO2Nhc2VcInVcIjpyZXR1cm4geC50KGMudW5pdmVyc2FsU29ydGFibGVEYXRlVGltZSk7Y2FzZVwieVwiOnJldHVybiB4LnQoYy55ZWFyTW9udGgpO319XG52YXIgb3JkPWZ1bmN0aW9uKG4pe3N3aXRjaChuKjEpe2Nhc2UgMTpjYXNlIDIxOmNhc2UgMzE6cmV0dXJuXCJzdFwiO2Nhc2UgMjpjYXNlIDIyOnJldHVyblwibmRcIjtjYXNlIDM6Y2FzZSAyMzpyZXR1cm5cInJkXCI7ZGVmYXVsdDpyZXR1cm5cInRoXCI7fX07cmV0dXJuIGZvcm1hdD9mb3JtYXQucmVwbGFjZSgvKFxcXFwpPyhkZD9kP2Q/fE1NP00/TT98eXk/eT95P3xoaD98SEg/fG1tP3xzcz98dHQ/fFMpL2csZnVuY3Rpb24obSl7aWYobS5jaGFyQXQoMCk9PT1cIlxcXFxcIil7cmV0dXJuIG0ucmVwbGFjZShcIlxcXFxcIixcIlwiKTt9XG54Lmg9eC5nZXRIb3Vycztzd2l0Y2gobSl7Y2FzZVwiaGhcIjpyZXR1cm4gcCh4LmgoKTwxMz8oeC5oKCk9PT0wPzEyOnguaCgpKTooeC5oKCktMTIpKTtjYXNlXCJoXCI6cmV0dXJuIHguaCgpPDEzPyh4LmgoKT09PTA/MTI6eC5oKCkpOih4LmgoKS0xMik7Y2FzZVwiSEhcIjpyZXR1cm4gcCh4LmgoKSk7Y2FzZVwiSFwiOnJldHVybiB4LmgoKTtjYXNlXCJtbVwiOnJldHVybiBwKHguZ2V0TWludXRlcygpKTtjYXNlXCJtXCI6cmV0dXJuIHguZ2V0TWludXRlcygpO2Nhc2VcInNzXCI6cmV0dXJuIHAoeC5nZXRTZWNvbmRzKCkpO2Nhc2VcInNcIjpyZXR1cm4geC5nZXRTZWNvbmRzKCk7Y2FzZVwieXl5eVwiOnJldHVybiBwKHguZ2V0RnVsbFllYXIoKSw0KTtjYXNlXCJ5eVwiOnJldHVybiBwKHguZ2V0RnVsbFllYXIoKSk7Y2FzZVwiZGRkZFwiOnJldHVybiAkQy5kYXlOYW1lc1t4LmdldERheSgpXTtjYXNlXCJkZGRcIjpyZXR1cm4gJEMuYWJicmV2aWF0ZWREYXlOYW1lc1t4LmdldERheSgpXTtjYXNlXCJkZFwiOnJldHVybiBwKHguZ2V0RGF0ZSgpKTtjYXNlXCJkXCI6cmV0dXJuIHguZ2V0RGF0ZSgpO2Nhc2VcIk1NTU1cIjpyZXR1cm4gJEMubW9udGhOYW1lc1t4LmdldE1vbnRoKCldO2Nhc2VcIk1NTVwiOnJldHVybiAkQy5hYmJyZXZpYXRlZE1vbnRoTmFtZXNbeC5nZXRNb250aCgpXTtjYXNlXCJNTVwiOnJldHVybiBwKCh4LmdldE1vbnRoKCkrMSkpO2Nhc2VcIk1cIjpyZXR1cm4geC5nZXRNb250aCgpKzE7Y2FzZVwidFwiOnJldHVybiB4LmgoKTwxMj8kQy5hbURlc2lnbmF0b3Iuc3Vic3RyaW5nKDAsMSk6JEMucG1EZXNpZ25hdG9yLnN1YnN0cmluZygwLDEpO2Nhc2VcInR0XCI6cmV0dXJuIHguaCgpPDEyPyRDLmFtRGVzaWduYXRvcjokQy5wbURlc2lnbmF0b3I7Y2FzZVwiU1wiOnJldHVybiBvcmQoeC5nZXREYXRlKCkpO2RlZmF1bHQ6cmV0dXJuIG07fX0pOnRoaXMuX3RvU3RyaW5nKCk7fTt9KCkpO1xuKGZ1bmN0aW9uKCl7dmFyICREPURhdGUsJFA9JEQucHJvdG90eXBlLCRDPSRELkN1bHR1cmVJbmZvLCROPU51bWJlci5wcm90b3R5cGU7JFAuX29yaWVudD0rMTskUC5fbnRoPW51bGw7JFAuX2lzPWZhbHNlOyRQLl9zYW1lPWZhbHNlOyRQLl9pc1NlY29uZD1mYWxzZTskTi5fZGF0ZUVsZW1lbnQ9XCJkYXlcIjskUC5uZXh0PWZ1bmN0aW9uKCl7dGhpcy5fb3JpZW50PSsxO3JldHVybiB0aGlzO307JEQubmV4dD1mdW5jdGlvbigpe3JldHVybiAkRC50b2RheSgpLm5leHQoKTt9OyRQLmxhc3Q9JFAucHJldj0kUC5wcmV2aW91cz1mdW5jdGlvbigpe3RoaXMuX29yaWVudD0tMTtyZXR1cm4gdGhpczt9OyRELmxhc3Q9JEQucHJldj0kRC5wcmV2aW91cz1mdW5jdGlvbigpe3JldHVybiAkRC50b2RheSgpLmxhc3QoKTt9OyRQLmlzPWZ1bmN0aW9uKCl7dGhpcy5faXM9dHJ1ZTtyZXR1cm4gdGhpczt9OyRQLnNhbWU9ZnVuY3Rpb24oKXt0aGlzLl9zYW1lPXRydWU7dGhpcy5faXNTZWNvbmQ9ZmFsc2U7cmV0dXJuIHRoaXM7fTskUC50b2RheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNhbWUoKS5kYXkoKTt9OyRQLndlZWtkYXk9ZnVuY3Rpb24oKXtpZih0aGlzLl9pcyl7dGhpcy5faXM9ZmFsc2U7cmV0dXJuKCF0aGlzLmlzKCkuc2F0KCkmJiF0aGlzLmlzKCkuc3VuKCkpO31cbnJldHVybiBmYWxzZTt9OyRQLmF0PWZ1bmN0aW9uKHRpbWUpe3JldHVybih0eXBlb2YgdGltZT09PVwic3RyaW5nXCIpPyRELnBhcnNlKHRoaXMudG9TdHJpbmcoXCJkXCIpK1wiIFwiK3RpbWUpOnRoaXMuc2V0KHRpbWUpO307JE4uZnJvbU5vdz0kTi5hZnRlcj1mdW5jdGlvbihkYXRlKXt2YXIgYz17fTtjW3RoaXMuX2RhdGVFbGVtZW50XT10aGlzO3JldHVybigoIWRhdGUpP25ldyBEYXRlKCk6ZGF0ZS5jbG9uZSgpKS5hZGQoYyk7fTskTi5hZ289JE4uYmVmb3JlPWZ1bmN0aW9uKGRhdGUpe3ZhciBjPXt9O2NbdGhpcy5fZGF0ZUVsZW1lbnRdPXRoaXMqLTE7cmV0dXJuKCghZGF0ZSk/bmV3IERhdGUoKTpkYXRlLmNsb25lKCkpLmFkZChjKTt9O3ZhciBkeD0oXCJzdW5kYXkgbW9uZGF5IHR1ZXNkYXkgd2VkbmVzZGF5IHRodXJzZGF5IGZyaWRheSBzYXR1cmRheVwiKS5zcGxpdCgvXFxzLyksbXg9KFwiamFudWFyeSBmZWJydWFyeSBtYXJjaCBhcHJpbCBtYXkganVuZSBqdWx5IGF1Z3VzdCBzZXB0ZW1iZXIgb2N0b2JlciBub3ZlbWJlciBkZWNlbWJlclwiKS5zcGxpdCgvXFxzLykscHg9KFwiTWlsbGlzZWNvbmQgU2Vjb25kIE1pbnV0ZSBIb3VyIERheSBXZWVrIE1vbnRoIFllYXJcIikuc3BsaXQoL1xccy8pLHB4Zj0oXCJNaWxsaXNlY29uZHMgU2Vjb25kcyBNaW51dGVzIEhvdXJzIERhdGUgV2VlayBNb250aCBGdWxsWWVhclwiKS5zcGxpdCgvXFxzLyksbnRoPShcImZpbmFsIGZpcnN0IHNlY29uZCB0aGlyZCBmb3VydGggZmlmdGhcIikuc3BsaXQoL1xccy8pLGRlOyRQLnRvT2JqZWN0PWZ1bmN0aW9uKCl7dmFyIG89e307Zm9yKHZhciBpPTA7aTxweC5sZW5ndGg7aSsrKXtvW3B4W2ldLnRvTG93ZXJDYXNlKCldPXRoaXNbXCJnZXRcIitweGZbaV1dKCk7fVxucmV0dXJuIG87fTskRC5mcm9tT2JqZWN0PWZ1bmN0aW9uKGNvbmZpZyl7Y29uZmlnLndlZWs9bnVsbDtyZXR1cm4gRGF0ZS50b2RheSgpLnNldChjb25maWcpO307dmFyIGRmPWZ1bmN0aW9uKG4pe3JldHVybiBmdW5jdGlvbigpe2lmKHRoaXMuX2lzKXt0aGlzLl9pcz1mYWxzZTtyZXR1cm4gdGhpcy5nZXREYXkoKT09bjt9XG5pZih0aGlzLl9udGghPT1udWxsKXtpZih0aGlzLl9pc1NlY29uZCl7dGhpcy5hZGRTZWNvbmRzKHRoaXMuX29yaWVudCotMSk7fVxudGhpcy5faXNTZWNvbmQ9ZmFsc2U7dmFyIG50ZW1wPXRoaXMuX250aDt0aGlzLl9udGg9bnVsbDt2YXIgdGVtcD10aGlzLmNsb25lKCkubW92ZVRvTGFzdERheU9mTW9udGgoKTt0aGlzLm1vdmVUb050aE9jY3VycmVuY2UobixudGVtcCk7aWYodGhpcz50ZW1wKXt0aHJvdyBuZXcgUmFuZ2VFcnJvcigkRC5nZXREYXlOYW1lKG4pK1wiIGRvZXMgbm90IG9jY3VyIFwiK250ZW1wK1wiIHRpbWVzIGluIHRoZSBtb250aCBvZiBcIiskRC5nZXRNb250aE5hbWUodGVtcC5nZXRNb250aCgpKStcIiBcIit0ZW1wLmdldEZ1bGxZZWFyKCkrXCIuXCIpO31cbnJldHVybiB0aGlzO31cbnJldHVybiB0aGlzLm1vdmVUb0RheU9mV2VlayhuLHRoaXMuX29yaWVudCk7fTt9O3ZhciBzZGY9ZnVuY3Rpb24obil7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9JEQudG9kYXkoKSxzaGlmdD1uLXQuZ2V0RGF5KCk7aWYobj09PTAmJiRDLmZpcnN0RGF5T2ZXZWVrPT09MSYmdC5nZXREYXkoKSE9PTApe3NoaWZ0PXNoaWZ0Kzc7fVxucmV0dXJuIHQuYWRkRGF5cyhzaGlmdCk7fTt9O2Zvcih2YXIgaT0wO2k8ZHgubGVuZ3RoO2krKyl7JERbZHhbaV0udG9VcHBlckNhc2UoKV09JERbZHhbaV0udG9VcHBlckNhc2UoKS5zdWJzdHJpbmcoMCwzKV09aTskRFtkeFtpXV09JERbZHhbaV0uc3Vic3RyaW5nKDAsMyldPXNkZihpKTskUFtkeFtpXV09JFBbZHhbaV0uc3Vic3RyaW5nKDAsMyldPWRmKGkpO31cbnZhciBtZj1mdW5jdGlvbihuKXtyZXR1cm4gZnVuY3Rpb24oKXtpZih0aGlzLl9pcyl7dGhpcy5faXM9ZmFsc2U7cmV0dXJuIHRoaXMuZ2V0TW9udGgoKT09PW47fVxucmV0dXJuIHRoaXMubW92ZVRvTW9udGgobix0aGlzLl9vcmllbnQpO307fTt2YXIgc21mPWZ1bmN0aW9uKG4pe3JldHVybiBmdW5jdGlvbigpe3JldHVybiAkRC50b2RheSgpLnNldCh7bW9udGg6bixkYXk6MX0pO307fTtmb3IodmFyIGo9MDtqPG14Lmxlbmd0aDtqKyspeyREW214W2pdLnRvVXBwZXJDYXNlKCldPSREW214W2pdLnRvVXBwZXJDYXNlKCkuc3Vic3RyaW5nKDAsMyldPWo7JERbbXhbal1dPSREW214W2pdLnN1YnN0cmluZygwLDMpXT1zbWYoaik7JFBbbXhbal1dPSRQW214W2pdLnN1YnN0cmluZygwLDMpXT1tZihqKTt9XG52YXIgZWY9ZnVuY3Rpb24oail7cmV0dXJuIGZ1bmN0aW9uKCl7aWYodGhpcy5faXNTZWNvbmQpe3RoaXMuX2lzU2Vjb25kPWZhbHNlO3JldHVybiB0aGlzO31cbmlmKHRoaXMuX3NhbWUpe3RoaXMuX3NhbWU9dGhpcy5faXM9ZmFsc2U7dmFyIG8xPXRoaXMudG9PYmplY3QoKSxvMj0oYXJndW1lbnRzWzBdfHxuZXcgRGF0ZSgpKS50b09iamVjdCgpLHY9XCJcIixrPWoudG9Mb3dlckNhc2UoKTtmb3IodmFyIG09KHB4Lmxlbmd0aC0xKTttPi0xO20tLSl7dj1weFttXS50b0xvd2VyQ2FzZSgpO2lmKG8xW3ZdIT1vMlt2XSl7cmV0dXJuIGZhbHNlO31cbmlmKGs9PXYpe2JyZWFrO319XG5yZXR1cm4gdHJ1ZTt9XG5pZihqLnN1YnN0cmluZyhqLmxlbmd0aC0xKSE9XCJzXCIpe2orPVwic1wiO31cbnJldHVybiB0aGlzW1wiYWRkXCIral0odGhpcy5fb3JpZW50KTt9O307dmFyIG5mPWZ1bmN0aW9uKG4pe3JldHVybiBmdW5jdGlvbigpe3RoaXMuX2RhdGVFbGVtZW50PW47cmV0dXJuIHRoaXM7fTt9O2Zvcih2YXIgaz0wO2s8cHgubGVuZ3RoO2srKyl7ZGU9cHhba10udG9Mb3dlckNhc2UoKTskUFtkZV09JFBbZGUrXCJzXCJdPWVmKHB4W2tdKTskTltkZV09JE5bZGUrXCJzXCJdPW5mKGRlKTt9XG4kUC5fc3M9ZWYoXCJTZWNvbmRcIik7dmFyIG50aGZuPWZ1bmN0aW9uKG4pe3JldHVybiBmdW5jdGlvbihkYXlPZldlZWspe2lmKHRoaXMuX3NhbWUpe3JldHVybiB0aGlzLl9zcyhhcmd1bWVudHNbMF0pO31cbmlmKGRheU9mV2Vla3x8ZGF5T2ZXZWVrPT09MCl7cmV0dXJuIHRoaXMubW92ZVRvTnRoT2NjdXJyZW5jZShkYXlPZldlZWssbik7fVxudGhpcy5fbnRoPW47aWYobj09PTImJihkYXlPZldlZWs9PT11bmRlZmluZWR8fGRheU9mV2Vlaz09PW51bGwpKXt0aGlzLl9pc1NlY29uZD10cnVlO3JldHVybiB0aGlzLmFkZFNlY29uZHModGhpcy5fb3JpZW50KTt9XG5yZXR1cm4gdGhpczt9O307Zm9yKHZhciBsPTA7bDxudGgubGVuZ3RoO2wrKyl7JFBbbnRoW2xdXT0obD09PTApP250aGZuKC0xKTpudGhmbihsKTt9fSgpKTtcbihmdW5jdGlvbigpe0RhdGUuUGFyc2luZz17RXhjZXB0aW9uOmZ1bmN0aW9uKHMpe3RoaXMubWVzc2FnZT1cIlBhcnNlIGVycm9yIGF0ICdcIitzLnN1YnN0cmluZygwLDEwKStcIiAuLi4nXCI7fX07dmFyICRQPURhdGUuUGFyc2luZzt2YXIgXz0kUC5PcGVyYXRvcnM9e3J0b2tlbjpmdW5jdGlvbihyKXtyZXR1cm4gZnVuY3Rpb24ocyl7dmFyIG14PXMubWF0Y2gocik7aWYobXgpe3JldHVybihbbXhbMF0scy5zdWJzdHJpbmcobXhbMF0ubGVuZ3RoKV0pO31lbHNle3Rocm93IG5ldyAkUC5FeGNlcHRpb24ocyk7fX07fSx0b2tlbjpmdW5jdGlvbihzKXtyZXR1cm4gZnVuY3Rpb24ocyl7cmV0dXJuIF8ucnRva2VuKG5ldyBSZWdFeHAoXCJeXFxzKlwiK3MrXCJcXHMqXCIpKShzKTt9O30sc3Rva2VuOmZ1bmN0aW9uKHMpe3JldHVybiBfLnJ0b2tlbihuZXcgUmVnRXhwKFwiXlwiK3MpKTt9LHVudGlsOmZ1bmN0aW9uKHApe3JldHVybiBmdW5jdGlvbihzKXt2YXIgcXg9W10scng9bnVsbDt3aGlsZShzLmxlbmd0aCl7dHJ5e3J4PXAuY2FsbCh0aGlzLHMpO31jYXRjaChlKXtxeC5wdXNoKHJ4WzBdKTtzPXJ4WzFdO2NvbnRpbnVlO31cbmJyZWFrO31cbnJldHVybltxeCxzXTt9O30sbWFueTpmdW5jdGlvbihwKXtyZXR1cm4gZnVuY3Rpb24ocyl7dmFyIHJ4PVtdLHI9bnVsbDt3aGlsZShzLmxlbmd0aCl7dHJ5e3I9cC5jYWxsKHRoaXMscyk7fWNhdGNoKGUpe3JldHVybltyeCxzXTt9XG5yeC5wdXNoKHJbMF0pO3M9clsxXTt9XG5yZXR1cm5bcngsc107fTt9LG9wdGlvbmFsOmZ1bmN0aW9uKHApe3JldHVybiBmdW5jdGlvbihzKXt2YXIgcj1udWxsO3RyeXtyPXAuY2FsbCh0aGlzLHMpO31jYXRjaChlKXtyZXR1cm5bbnVsbCxzXTt9XG5yZXR1cm5bclswXSxyWzFdXTt9O30sbm90OmZ1bmN0aW9uKHApe3JldHVybiBmdW5jdGlvbihzKXt0cnl7cC5jYWxsKHRoaXMscyk7fWNhdGNoKGUpe3JldHVybltudWxsLHNdO31cbnRocm93IG5ldyAkUC5FeGNlcHRpb24ocyk7fTt9LGlnbm9yZTpmdW5jdGlvbihwKXtyZXR1cm4gcD9mdW5jdGlvbihzKXt2YXIgcj1udWxsO3I9cC5jYWxsKHRoaXMscyk7cmV0dXJuW251bGwsclsxXV07fTpudWxsO30scHJvZHVjdDpmdW5jdGlvbigpe3ZhciBweD1hcmd1bWVudHNbMF0scXg9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpLHJ4PVtdO2Zvcih2YXIgaT0wO2k8cHgubGVuZ3RoO2krKyl7cngucHVzaChfLmVhY2gocHhbaV0scXgpKTt9XG5yZXR1cm4gcng7fSxjYWNoZTpmdW5jdGlvbihydWxlKXt2YXIgY2FjaGU9e30scj1udWxsO3JldHVybiBmdW5jdGlvbihzKXt0cnl7cj1jYWNoZVtzXT0oY2FjaGVbc118fHJ1bGUuY2FsbCh0aGlzLHMpKTt9Y2F0Y2goZSl7cj1jYWNoZVtzXT1lO31cbmlmKHIgaW5zdGFuY2VvZiAkUC5FeGNlcHRpb24pe3Rocm93IHI7fWVsc2V7cmV0dXJuIHI7fX07fSxhbnk6ZnVuY3Rpb24oKXt2YXIgcHg9YXJndW1lbnRzO3JldHVybiBmdW5jdGlvbihzKXt2YXIgcj1udWxsO2Zvcih2YXIgaT0wO2k8cHgubGVuZ3RoO2krKyl7aWYocHhbaV09PW51bGwpe2NvbnRpbnVlO31cbnRyeXtyPShweFtpXS5jYWxsKHRoaXMscykpO31jYXRjaChlKXtyPW51bGw7fVxuaWYocil7cmV0dXJuIHI7fX1cbnRocm93IG5ldyAkUC5FeGNlcHRpb24ocyk7fTt9LGVhY2g6ZnVuY3Rpb24oKXt2YXIgcHg9YXJndW1lbnRzO3JldHVybiBmdW5jdGlvbihzKXt2YXIgcng9W10scj1udWxsO2Zvcih2YXIgaT0wO2k8cHgubGVuZ3RoO2krKyl7aWYocHhbaV09PW51bGwpe2NvbnRpbnVlO31cbnRyeXtyPShweFtpXS5jYWxsKHRoaXMscykpO31jYXRjaChlKXt0aHJvdyBuZXcgJFAuRXhjZXB0aW9uKHMpO31cbnJ4LnB1c2goclswXSk7cz1yWzFdO31cbnJldHVybltyeCxzXTt9O30sYWxsOmZ1bmN0aW9uKCl7dmFyIHB4PWFyZ3VtZW50cyxfPV87cmV0dXJuIF8uZWFjaChfLm9wdGlvbmFsKHB4KSk7fSxzZXF1ZW5jZTpmdW5jdGlvbihweCxkLGMpe2Q9ZHx8Xy5ydG9rZW4oL15cXHMqLyk7Yz1jfHxudWxsO2lmKHB4Lmxlbmd0aD09MSl7cmV0dXJuIHB4WzBdO31cbnJldHVybiBmdW5jdGlvbihzKXt2YXIgcj1udWxsLHE9bnVsbDt2YXIgcng9W107Zm9yKHZhciBpPTA7aTxweC5sZW5ndGg7aSsrKXt0cnl7cj1weFtpXS5jYWxsKHRoaXMscyk7fWNhdGNoKGUpe2JyZWFrO31cbnJ4LnB1c2goclswXSk7dHJ5e3E9ZC5jYWxsKHRoaXMsclsxXSk7fWNhdGNoKGV4KXtxPW51bGw7YnJlYWs7fVxucz1xWzFdO31cbmlmKCFyKXt0aHJvdyBuZXcgJFAuRXhjZXB0aW9uKHMpO31cbmlmKHEpe3Rocm93IG5ldyAkUC5FeGNlcHRpb24ocVsxXSk7fVxuaWYoYyl7dHJ5e3I9Yy5jYWxsKHRoaXMsclsxXSk7fWNhdGNoKGV5KXt0aHJvdyBuZXcgJFAuRXhjZXB0aW9uKHJbMV0pO319XG5yZXR1cm5bcngsKHI/clsxXTpzKV07fTt9LGJldHdlZW46ZnVuY3Rpb24oZDEscCxkMil7ZDI9ZDJ8fGQxO3ZhciBfZm49Xy5lYWNoKF8uaWdub3JlKGQxKSxwLF8uaWdub3JlKGQyKSk7cmV0dXJuIGZ1bmN0aW9uKHMpe3ZhciByeD1fZm4uY2FsbCh0aGlzLHMpO3JldHVybltbcnhbMF1bMF0sclswXVsyXV0scnhbMV1dO307fSxsaXN0OmZ1bmN0aW9uKHAsZCxjKXtkPWR8fF8ucnRva2VuKC9eXFxzKi8pO2M9Y3x8bnVsbDtyZXR1cm4ocCBpbnN0YW5jZW9mIEFycmF5P18uZWFjaChfLnByb2R1Y3QocC5zbGljZSgwLC0xKSxfLmlnbm9yZShkKSkscC5zbGljZSgtMSksXy5pZ25vcmUoYykpOl8uZWFjaChfLm1hbnkoXy5lYWNoKHAsXy5pZ25vcmUoZCkpKSxweCxfLmlnbm9yZShjKSkpO30sc2V0OmZ1bmN0aW9uKHB4LGQsYyl7ZD1kfHxfLnJ0b2tlbigvXlxccyovKTtjPWN8fG51bGw7cmV0dXJuIGZ1bmN0aW9uKHMpe3ZhciByPW51bGwscD1udWxsLHE9bnVsbCxyeD1udWxsLGJlc3Q9W1tdLHNdLGxhc3Q9ZmFsc2U7Zm9yKHZhciBpPTA7aTxweC5sZW5ndGg7aSsrKXtxPW51bGw7cD1udWxsO3I9bnVsbDtsYXN0PShweC5sZW5ndGg9PTEpO3RyeXtyPXB4W2ldLmNhbGwodGhpcyxzKTt9Y2F0Y2goZSl7Y29udGludWU7fVxucng9W1tyWzBdXSxyWzFdXTtpZihyWzFdLmxlbmd0aD4wJiYhbGFzdCl7dHJ5e3E9ZC5jYWxsKHRoaXMsclsxXSk7fWNhdGNoKGV4KXtsYXN0PXRydWU7fX1lbHNle2xhc3Q9dHJ1ZTt9XG5pZighbGFzdCYmcVsxXS5sZW5ndGg9PT0wKXtsYXN0PXRydWU7fVxuaWYoIWxhc3Qpe3ZhciBxeD1bXTtmb3IodmFyIGo9MDtqPHB4Lmxlbmd0aDtqKyspe2lmKGkhPWope3F4LnB1c2gocHhbal0pO319XG5wPV8uc2V0KHF4LGQpLmNhbGwodGhpcyxxWzFdKTtpZihwWzBdLmxlbmd0aD4wKXtyeFswXT1yeFswXS5jb25jYXQocFswXSk7cnhbMV09cFsxXTt9fVxuaWYocnhbMV0ubGVuZ3RoPGJlc3RbMV0ubGVuZ3RoKXtiZXN0PXJ4O31cbmlmKGJlc3RbMV0ubGVuZ3RoPT09MCl7YnJlYWs7fX1cbmlmKGJlc3RbMF0ubGVuZ3RoPT09MCl7cmV0dXJuIGJlc3Q7fVxuaWYoYyl7dHJ5e3E9Yy5jYWxsKHRoaXMsYmVzdFsxXSk7fWNhdGNoKGV5KXt0aHJvdyBuZXcgJFAuRXhjZXB0aW9uKGJlc3RbMV0pO31cbmJlc3RbMV09cVsxXTt9XG5yZXR1cm4gYmVzdDt9O30sZm9yd2FyZDpmdW5jdGlvbihncixmbmFtZSl7cmV0dXJuIGZ1bmN0aW9uKHMpe3JldHVybiBncltmbmFtZV0uY2FsbCh0aGlzLHMpO307fSxyZXBsYWNlOmZ1bmN0aW9uKHJ1bGUscmVwbCl7cmV0dXJuIGZ1bmN0aW9uKHMpe3ZhciByPXJ1bGUuY2FsbCh0aGlzLHMpO3JldHVybltyZXBsLHJbMV1dO307fSxwcm9jZXNzOmZ1bmN0aW9uKHJ1bGUsZm4pe3JldHVybiBmdW5jdGlvbihzKXt2YXIgcj1ydWxlLmNhbGwodGhpcyxzKTtyZXR1cm5bZm4uY2FsbCh0aGlzLHJbMF0pLHJbMV1dO307fSxtaW46ZnVuY3Rpb24obWluLHJ1bGUpe3JldHVybiBmdW5jdGlvbihzKXt2YXIgcng9cnVsZS5jYWxsKHRoaXMscyk7aWYocnhbMF0ubGVuZ3RoPG1pbil7dGhyb3cgbmV3ICRQLkV4Y2VwdGlvbihzKTt9XG5yZXR1cm4gcng7fTt9fTt2YXIgX2dlbmVyYXRvcj1mdW5jdGlvbihvcCl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGFyZ3M9bnVsbCxyeD1bXTtpZihhcmd1bWVudHMubGVuZ3RoPjEpe2FyZ3M9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTt9ZWxzZSBpZihhcmd1bWVudHNbMF1pbnN0YW5jZW9mIEFycmF5KXthcmdzPWFyZ3VtZW50c1swXTt9XG5pZihhcmdzKXtmb3IodmFyIGk9MCxweD1hcmdzLnNoaWZ0KCk7aTxweC5sZW5ndGg7aSsrKXthcmdzLnVuc2hpZnQocHhbaV0pO3J4LnB1c2gob3AuYXBwbHkobnVsbCxhcmdzKSk7YXJncy5zaGlmdCgpO3JldHVybiByeDt9fWVsc2V7cmV0dXJuIG9wLmFwcGx5KG51bGwsYXJndW1lbnRzKTt9fTt9O3ZhciBneD1cIm9wdGlvbmFsIG5vdCBpZ25vcmUgY2FjaGVcIi5zcGxpdCgvXFxzLyk7Zm9yKHZhciBpPTA7aTxneC5sZW5ndGg7aSsrKXtfW2d4W2ldXT1fZ2VuZXJhdG9yKF9bZ3hbaV1dKTt9XG52YXIgX3ZlY3Rvcj1mdW5jdGlvbihvcCl7cmV0dXJuIGZ1bmN0aW9uKCl7aWYoYXJndW1lbnRzWzBdaW5zdGFuY2VvZiBBcnJheSl7cmV0dXJuIG9wLmFwcGx5KG51bGwsYXJndW1lbnRzWzBdKTt9ZWxzZXtyZXR1cm4gb3AuYXBwbHkobnVsbCxhcmd1bWVudHMpO319O307dmFyIHZ4PVwiZWFjaCBhbnkgYWxsXCIuc3BsaXQoL1xccy8pO2Zvcih2YXIgaj0wO2o8dngubGVuZ3RoO2orKyl7X1t2eFtqXV09X3ZlY3RvcihfW3Z4W2pdXSk7fX0oKSk7KGZ1bmN0aW9uKCl7dmFyICREPURhdGUsJFA9JEQucHJvdG90eXBlLCRDPSRELkN1bHR1cmVJbmZvO3ZhciBmbGF0dGVuQW5kQ29tcGFjdD1mdW5jdGlvbihheCl7dmFyIHJ4PVtdO2Zvcih2YXIgaT0wO2k8YXgubGVuZ3RoO2krKyl7aWYoYXhbaV1pbnN0YW5jZW9mIEFycmF5KXtyeD1yeC5jb25jYXQoZmxhdHRlbkFuZENvbXBhY3QoYXhbaV0pKTt9ZWxzZXtpZihheFtpXSl7cngucHVzaChheFtpXSk7fX19XG5yZXR1cm4gcng7fTskRC5HcmFtbWFyPXt9OyRELlRyYW5zbGF0b3I9e2hvdXI6ZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKCl7dGhpcy5ob3VyPU51bWJlcihzKTt9O30sbWludXRlOmZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbigpe3RoaXMubWludXRlPU51bWJlcihzKTt9O30sc2Vjb25kOmZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbigpe3RoaXMuc2Vjb25kPU51bWJlcihzKTt9O30sbWVyaWRpYW46ZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKCl7dGhpcy5tZXJpZGlhbj1zLnNsaWNlKDAsMSkudG9Mb3dlckNhc2UoKTt9O30sdGltZXpvbmU6ZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIG49cy5yZXBsYWNlKC9bXlxcZFxcK1xcLV0vZyxcIlwiKTtpZihuLmxlbmd0aCl7dGhpcy50aW1lem9uZU9mZnNldD1OdW1iZXIobik7fWVsc2V7dGhpcy50aW1lem9uZT1zLnRvTG93ZXJDYXNlKCk7fX07fSxkYXk6ZnVuY3Rpb24oeCl7dmFyIHM9eFswXTtyZXR1cm4gZnVuY3Rpb24oKXt0aGlzLmRheT1OdW1iZXIocy5tYXRjaCgvXFxkKy8pWzBdKTt9O30sbW9udGg6ZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKCl7dGhpcy5tb250aD0ocy5sZW5ndGg9PTMpP1wiamFuIGZlYiBtYXIgYXByIG1heSBqdW4ganVsIGF1ZyBzZXAgb2N0IG5vdiBkZWNcIi5pbmRleE9mKHMpLzQ6TnVtYmVyKHMpLTE7fTt9LHllYXI6ZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIG49TnVtYmVyKHMpO3RoaXMueWVhcj0oKHMubGVuZ3RoPjIpP246KG4rKCgobisyMDAwKTwkQy50d29EaWdpdFllYXJNYXgpPzIwMDA6MTkwMCkpKTt9O30scmRheTpmdW5jdGlvbihzKXtyZXR1cm4gZnVuY3Rpb24oKXtzd2l0Y2gocyl7Y2FzZVwieWVzdGVyZGF5XCI6dGhpcy5kYXlzPS0xO2JyZWFrO2Nhc2VcInRvbW9ycm93XCI6dGhpcy5kYXlzPTE7YnJlYWs7Y2FzZVwidG9kYXlcIjp0aGlzLmRheXM9MDticmVhaztjYXNlXCJub3dcIjp0aGlzLmRheXM9MDt0aGlzLm5vdz10cnVlO2JyZWFrO319O30sZmluaXNoRXhhY3Q6ZnVuY3Rpb24oeCl7eD0oeCBpbnN0YW5jZW9mIEFycmF5KT94Olt4XTtmb3IodmFyIGk9MDtpPHgubGVuZ3RoO2krKyl7aWYoeFtpXSl7eFtpXS5jYWxsKHRoaXMpO319XG52YXIgbm93PW5ldyBEYXRlKCk7aWYoKHRoaXMuaG91cnx8dGhpcy5taW51dGUpJiYoIXRoaXMubW9udGgmJiF0aGlzLnllYXImJiF0aGlzLmRheSkpe3RoaXMuZGF5PW5vdy5nZXREYXRlKCk7fVxuaWYoIXRoaXMueWVhcil7dGhpcy55ZWFyPW5vdy5nZXRGdWxsWWVhcigpO31cbmlmKCF0aGlzLm1vbnRoJiZ0aGlzLm1vbnRoIT09MCl7dGhpcy5tb250aD1ub3cuZ2V0TW9udGgoKTt9XG5pZighdGhpcy5kYXkpe3RoaXMuZGF5PTE7fVxuaWYoIXRoaXMuaG91cil7dGhpcy5ob3VyPTA7fVxuaWYoIXRoaXMubWludXRlKXt0aGlzLm1pbnV0ZT0wO31cbmlmKCF0aGlzLnNlY29uZCl7dGhpcy5zZWNvbmQ9MDt9XG5pZih0aGlzLm1lcmlkaWFuJiZ0aGlzLmhvdXIpe2lmKHRoaXMubWVyaWRpYW49PVwicFwiJiZ0aGlzLmhvdXI8MTIpe3RoaXMuaG91cj10aGlzLmhvdXIrMTI7fWVsc2UgaWYodGhpcy5tZXJpZGlhbj09XCJhXCImJnRoaXMuaG91cj09MTIpe3RoaXMuaG91cj0wO319XG5pZih0aGlzLmRheT4kRC5nZXREYXlzSW5Nb250aCh0aGlzLnllYXIsdGhpcy5tb250aCkpe3Rocm93IG5ldyBSYW5nZUVycm9yKHRoaXMuZGF5K1wiIGlzIG5vdCBhIHZhbGlkIHZhbHVlIGZvciBkYXlzLlwiKTt9XG52YXIgcj1uZXcgRGF0ZSh0aGlzLnllYXIsdGhpcy5tb250aCx0aGlzLmRheSx0aGlzLmhvdXIsdGhpcy5taW51dGUsdGhpcy5zZWNvbmQpO2lmKHRoaXMudGltZXpvbmUpe3Iuc2V0KHt0aW1lem9uZTp0aGlzLnRpbWV6b25lfSk7fWVsc2UgaWYodGhpcy50aW1lem9uZU9mZnNldCl7ci5zZXQoe3RpbWV6b25lT2Zmc2V0OnRoaXMudGltZXpvbmVPZmZzZXR9KTt9XG5yZXR1cm4gcjt9LGZpbmlzaDpmdW5jdGlvbih4KXt4PSh4IGluc3RhbmNlb2YgQXJyYXkpP2ZsYXR0ZW5BbmRDb21wYWN0KHgpOlt4XTtpZih4Lmxlbmd0aD09PTApe3JldHVybiBudWxsO31cbmZvcih2YXIgaT0wO2k8eC5sZW5ndGg7aSsrKXtpZih0eXBlb2YgeFtpXT09XCJmdW5jdGlvblwiKXt4W2ldLmNhbGwodGhpcyk7fX1cbnZhciB0b2RheT0kRC50b2RheSgpO2lmKHRoaXMubm93JiYhdGhpcy51bml0JiYhdGhpcy5vcGVyYXRvcil7cmV0dXJuIG5ldyBEYXRlKCk7fWVsc2UgaWYodGhpcy5ub3cpe3RvZGF5PW5ldyBEYXRlKCk7fVxudmFyIGV4cHJlc3Npb249ISEodGhpcy5kYXlzJiZ0aGlzLmRheXMhPT1udWxsfHx0aGlzLm9yaWVudHx8dGhpcy5vcGVyYXRvcik7dmFyIGdhcCxtb2Qsb3JpZW50O29yaWVudD0oKHRoaXMub3JpZW50PT1cInBhc3RcInx8dGhpcy5vcGVyYXRvcj09XCJzdWJ0cmFjdFwiKT8tMToxKTtpZighdGhpcy5ub3cmJlwiaG91ciBtaW51dGUgc2Vjb25kXCIuaW5kZXhPZih0aGlzLnVuaXQpIT0tMSl7dG9kYXkuc2V0VGltZVRvTm93KCk7fVxuaWYodGhpcy5tb250aHx8dGhpcy5tb250aD09PTApe2lmKFwieWVhciBkYXkgaG91ciBtaW51dGUgc2Vjb25kXCIuaW5kZXhPZih0aGlzLnVuaXQpIT0tMSl7dGhpcy52YWx1ZT10aGlzLm1vbnRoKzE7dGhpcy5tb250aD1udWxsO2V4cHJlc3Npb249dHJ1ZTt9fVxuaWYoIWV4cHJlc3Npb24mJnRoaXMud2Vla2RheSYmIXRoaXMuZGF5JiYhdGhpcy5kYXlzKXt2YXIgdGVtcD1EYXRlW3RoaXMud2Vla2RheV0oKTt0aGlzLmRheT10ZW1wLmdldERhdGUoKTtpZighdGhpcy5tb250aCl7dGhpcy5tb250aD10ZW1wLmdldE1vbnRoKCk7fVxudGhpcy55ZWFyPXRlbXAuZ2V0RnVsbFllYXIoKTt9XG5pZihleHByZXNzaW9uJiZ0aGlzLndlZWtkYXkmJnRoaXMudW5pdCE9XCJtb250aFwiKXt0aGlzLnVuaXQ9XCJkYXlcIjtnYXA9KCRELmdldERheU51bWJlckZyb21OYW1lKHRoaXMud2Vla2RheSktdG9kYXkuZ2V0RGF5KCkpO21vZD03O3RoaXMuZGF5cz1nYXA/KChnYXArKG9yaWVudCptb2QpKSVtb2QpOihvcmllbnQqbW9kKTt9XG5pZih0aGlzLm1vbnRoJiZ0aGlzLnVuaXQ9PVwiZGF5XCImJnRoaXMub3BlcmF0b3Ipe3RoaXMudmFsdWU9KHRoaXMubW9udGgrMSk7dGhpcy5tb250aD1udWxsO31cbmlmKHRoaXMudmFsdWUhPW51bGwmJnRoaXMubW9udGghPW51bGwmJnRoaXMueWVhciE9bnVsbCl7dGhpcy5kYXk9dGhpcy52YWx1ZSoxO31cbmlmKHRoaXMubW9udGgmJiF0aGlzLmRheSYmdGhpcy52YWx1ZSl7dG9kYXkuc2V0KHtkYXk6dGhpcy52YWx1ZSoxfSk7aWYoIWV4cHJlc3Npb24pe3RoaXMuZGF5PXRoaXMudmFsdWUqMTt9fVxuaWYoIXRoaXMubW9udGgmJnRoaXMudmFsdWUmJnRoaXMudW5pdD09XCJtb250aFwiJiYhdGhpcy5ub3cpe3RoaXMubW9udGg9dGhpcy52YWx1ZTtleHByZXNzaW9uPXRydWU7fVxuaWYoZXhwcmVzc2lvbiYmKHRoaXMubW9udGh8fHRoaXMubW9udGg9PT0wKSYmdGhpcy51bml0IT1cInllYXJcIil7dGhpcy51bml0PVwibW9udGhcIjtnYXA9KHRoaXMubW9udGgtdG9kYXkuZ2V0TW9udGgoKSk7bW9kPTEyO3RoaXMubW9udGhzPWdhcD8oKGdhcCsob3JpZW50Km1vZCkpJW1vZCk6KG9yaWVudCptb2QpO3RoaXMubW9udGg9bnVsbDt9XG5pZighdGhpcy51bml0KXt0aGlzLnVuaXQ9XCJkYXlcIjt9XG5pZighdGhpcy52YWx1ZSYmdGhpcy5vcGVyYXRvciYmdGhpcy5vcGVyYXRvciE9PW51bGwmJnRoaXNbdGhpcy51bml0K1wic1wiXSYmdGhpc1t0aGlzLnVuaXQrXCJzXCJdIT09bnVsbCl7dGhpc1t0aGlzLnVuaXQrXCJzXCJdPXRoaXNbdGhpcy51bml0K1wic1wiXSsoKHRoaXMub3BlcmF0b3I9PVwiYWRkXCIpPzE6LTEpKyh0aGlzLnZhbHVlfHwwKSpvcmllbnQ7fWVsc2UgaWYodGhpc1t0aGlzLnVuaXQrXCJzXCJdPT1udWxsfHx0aGlzLm9wZXJhdG9yIT1udWxsKXtpZighdGhpcy52YWx1ZSl7dGhpcy52YWx1ZT0xO31cbnRoaXNbdGhpcy51bml0K1wic1wiXT10aGlzLnZhbHVlKm9yaWVudDt9XG5pZih0aGlzLm1lcmlkaWFuJiZ0aGlzLmhvdXIpe2lmKHRoaXMubWVyaWRpYW49PVwicFwiJiZ0aGlzLmhvdXI8MTIpe3RoaXMuaG91cj10aGlzLmhvdXIrMTI7fWVsc2UgaWYodGhpcy5tZXJpZGlhbj09XCJhXCImJnRoaXMuaG91cj09MTIpe3RoaXMuaG91cj0wO319XG5pZih0aGlzLndlZWtkYXkmJiF0aGlzLmRheSYmIXRoaXMuZGF5cyl7dmFyIHRlbXA9RGF0ZVt0aGlzLndlZWtkYXldKCk7dGhpcy5kYXk9dGVtcC5nZXREYXRlKCk7aWYodGVtcC5nZXRNb250aCgpIT09dG9kYXkuZ2V0TW9udGgoKSl7dGhpcy5tb250aD10ZW1wLmdldE1vbnRoKCk7fX1cbmlmKCh0aGlzLm1vbnRofHx0aGlzLm1vbnRoPT09MCkmJiF0aGlzLmRheSl7dGhpcy5kYXk9MTt9XG5pZighdGhpcy5vcmllbnQmJiF0aGlzLm9wZXJhdG9yJiZ0aGlzLnVuaXQ9PVwid2Vla1wiJiZ0aGlzLnZhbHVlJiYhdGhpcy5kYXkmJiF0aGlzLm1vbnRoKXtyZXR1cm4gRGF0ZS50b2RheSgpLnNldFdlZWsodGhpcy52YWx1ZSk7fVxuaWYoZXhwcmVzc2lvbiYmdGhpcy50aW1lem9uZSYmdGhpcy5kYXkmJnRoaXMuZGF5cyl7dGhpcy5kYXk9dGhpcy5kYXlzO31cbnJldHVybihleHByZXNzaW9uKT90b2RheS5hZGQodGhpcyk6dG9kYXkuc2V0KHRoaXMpO319O3ZhciBfPSRELlBhcnNpbmcuT3BlcmF0b3JzLGc9JEQuR3JhbW1hcix0PSRELlRyYW5zbGF0b3IsX2ZuO2cuZGF0ZVBhcnREZWxpbWl0ZXI9Xy5ydG9rZW4oL14oW1xcc1xcLVxcLlxcLFxcL1xceDI3XSspLyk7Zy50aW1lUGFydERlbGltaXRlcj1fLnN0b2tlbihcIjpcIik7Zy53aGl0ZVNwYWNlPV8ucnRva2VuKC9eXFxzKi8pO2cuZ2VuZXJhbERlbGltaXRlcj1fLnJ0b2tlbigvXigoW1xcc1xcLF18YXR8QHxvbikrKS8pO3ZhciBfQz17fTtnLmN0b2tlbj1mdW5jdGlvbihrZXlzKXt2YXIgZm49X0Nba2V5c107aWYoIWZuKXt2YXIgYz0kQy5yZWdleFBhdHRlcm5zO3ZhciBreD1rZXlzLnNwbGl0KC9cXHMrLykscHg9W107Zm9yKHZhciBpPTA7aTxreC5sZW5ndGg7aSsrKXtweC5wdXNoKF8ucmVwbGFjZShfLnJ0b2tlbihjW2t4W2ldXSksa3hbaV0pKTt9XG5mbj1fQ1trZXlzXT1fLmFueS5hcHBseShudWxsLHB4KTt9XG5yZXR1cm4gZm47fTtnLmN0b2tlbjI9ZnVuY3Rpb24oa2V5KXtyZXR1cm4gXy5ydG9rZW4oJEMucmVnZXhQYXR0ZXJuc1trZXldKTt9O2cuaD1fLmNhY2hlKF8ucHJvY2VzcyhfLnJ0b2tlbigvXigwWzAtOV18MVswLTJdfFsxLTldKS8pLHQuaG91cikpO2cuaGg9Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL14oMFswLTldfDFbMC0yXSkvKSx0LmhvdXIpKTtnLkg9Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL14oWzAtMV1bMC05XXwyWzAtM118WzAtOV0pLyksdC5ob3VyKSk7Zy5ISD1fLmNhY2hlKF8ucHJvY2VzcyhfLnJ0b2tlbigvXihbMC0xXVswLTldfDJbMC0zXSkvKSx0LmhvdXIpKTtnLm09Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL14oWzAtNV1bMC05XXxbMC05XSkvKSx0Lm1pbnV0ZSkpO2cubW09Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL15bMC01XVswLTldLyksdC5taW51dGUpKTtnLnM9Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL14oWzAtNV1bMC05XXxbMC05XSkvKSx0LnNlY29uZCkpO2cuc3M9Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL15bMC01XVswLTldLyksdC5zZWNvbmQpKTtnLmhtcz1fLmNhY2hlKF8uc2VxdWVuY2UoW2cuSCxnLm0sZy5zXSxnLnRpbWVQYXJ0RGVsaW1pdGVyKSk7Zy50PV8uY2FjaGUoXy5wcm9jZXNzKGcuY3Rva2VuMihcInNob3J0TWVyaWRpYW5cIiksdC5tZXJpZGlhbikpO2cudHQ9Xy5jYWNoZShfLnByb2Nlc3MoZy5jdG9rZW4yKFwibG9uZ01lcmlkaWFuXCIpLHQubWVyaWRpYW4pKTtnLno9Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL14oKFxcK3xcXC0pXFxzKlxcZFxcZFxcZFxcZCl8KChcXCt8XFwtKVxcZFxcZFxcOj9cXGRcXGQpLyksdC50aW1lem9uZSkpO2cueno9Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL14oKFxcK3xcXC0pXFxzKlxcZFxcZFxcZFxcZCl8KChcXCt8XFwtKVxcZFxcZFxcOj9cXGRcXGQpLyksdC50aW1lem9uZSkpO2cuenp6PV8uY2FjaGUoXy5wcm9jZXNzKGcuY3Rva2VuMihcInRpbWV6b25lXCIpLHQudGltZXpvbmUpKTtnLnRpbWVTdWZmaXg9Xy5lYWNoKF8uaWdub3JlKGcud2hpdGVTcGFjZSksXy5zZXQoW2cudHQsZy56enpdKSk7Zy50aW1lPV8uZWFjaChfLm9wdGlvbmFsKF8uaWdub3JlKF8uc3Rva2VuKFwiVFwiKSkpLGcuaG1zLGcudGltZVN1ZmZpeCk7Zy5kPV8uY2FjaGUoXy5wcm9jZXNzKF8uZWFjaChfLnJ0b2tlbigvXihbMC0yXVxcZHwzWzAtMV18XFxkKS8pLF8ub3B0aW9uYWwoZy5jdG9rZW4yKFwib3JkaW5hbFN1ZmZpeFwiKSkpLHQuZGF5KSk7Zy5kZD1fLmNhY2hlKF8ucHJvY2VzcyhfLmVhY2goXy5ydG9rZW4oL14oWzAtMl1cXGR8M1swLTFdKS8pLF8ub3B0aW9uYWwoZy5jdG9rZW4yKFwib3JkaW5hbFN1ZmZpeFwiKSkpLHQuZGF5KSk7Zy5kZGQ9Zy5kZGRkPV8uY2FjaGUoXy5wcm9jZXNzKGcuY3Rva2VuKFwic3VuIG1vbiB0dWUgd2VkIHRodSBmcmkgc2F0XCIpLGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbigpe3RoaXMud2Vla2RheT1zO307fSkpO2cuTT1fLmNhY2hlKF8ucHJvY2VzcyhfLnJ0b2tlbigvXigxWzAtMl18MFxcZHxcXGQpLyksdC5tb250aCkpO2cuTU09Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL14oMVswLTJdfDBcXGQpLyksdC5tb250aCkpO2cuTU1NPWcuTU1NTT1fLmNhY2hlKF8ucHJvY2VzcyhnLmN0b2tlbihcImphbiBmZWIgbWFyIGFwciBtYXkganVuIGp1bCBhdWcgc2VwIG9jdCBub3YgZGVjXCIpLHQubW9udGgpKTtnLnk9Xy5jYWNoZShfLnByb2Nlc3MoXy5ydG9rZW4oL14oXFxkXFxkPykvKSx0LnllYXIpKTtnLnl5PV8uY2FjaGUoXy5wcm9jZXNzKF8ucnRva2VuKC9eKFxcZFxcZCkvKSx0LnllYXIpKTtnLnl5eT1fLmNhY2hlKF8ucHJvY2VzcyhfLnJ0b2tlbigvXihcXGRcXGQ/XFxkP1xcZD8pLyksdC55ZWFyKSk7Zy55eXl5PV8uY2FjaGUoXy5wcm9jZXNzKF8ucnRva2VuKC9eKFxcZFxcZFxcZFxcZCkvKSx0LnllYXIpKTtfZm49ZnVuY3Rpb24oKXtyZXR1cm4gXy5lYWNoKF8uYW55LmFwcGx5KG51bGwsYXJndW1lbnRzKSxfLm5vdChnLmN0b2tlbjIoXCJ0aW1lQ29udGV4dFwiKSkpO307Zy5kYXk9X2ZuKGcuZCxnLmRkKTtnLm1vbnRoPV9mbihnLk0sZy5NTU0pO2cueWVhcj1fZm4oZy55eXl5LGcueXkpO2cub3JpZW50YXRpb249Xy5wcm9jZXNzKGcuY3Rva2VuKFwicGFzdCBmdXR1cmVcIiksZnVuY3Rpb24ocyl7cmV0dXJuIGZ1bmN0aW9uKCl7dGhpcy5vcmllbnQ9czt9O30pO2cub3BlcmF0b3I9Xy5wcm9jZXNzKGcuY3Rva2VuKFwiYWRkIHN1YnRyYWN0XCIpLGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbigpe3RoaXMub3BlcmF0b3I9czt9O30pO2cucmRheT1fLnByb2Nlc3MoZy5jdG9rZW4oXCJ5ZXN0ZXJkYXkgdG9tb3Jyb3cgdG9kYXkgbm93XCIpLHQucmRheSk7Zy51bml0PV8ucHJvY2VzcyhnLmN0b2tlbihcInNlY29uZCBtaW51dGUgaG91ciBkYXkgd2VlayBtb250aCB5ZWFyXCIpLGZ1bmN0aW9uKHMpe3JldHVybiBmdW5jdGlvbigpe3RoaXMudW5pdD1zO307fSk7Zy52YWx1ZT1fLnByb2Nlc3MoXy5ydG9rZW4oL15cXGRcXGQ/KHN0fG5kfHJkfHRoKT8vKSxmdW5jdGlvbihzKXtyZXR1cm4gZnVuY3Rpb24oKXt0aGlzLnZhbHVlPXMucmVwbGFjZSgvXFxEL2csXCJcIik7fTt9KTtnLmV4cHJlc3Npb249Xy5zZXQoW2cucmRheSxnLm9wZXJhdG9yLGcudmFsdWUsZy51bml0LGcub3JpZW50YXRpb24sZy5kZGQsZy5NTU1dKTtfZm49ZnVuY3Rpb24oKXtyZXR1cm4gXy5zZXQoYXJndW1lbnRzLGcuZGF0ZVBhcnREZWxpbWl0ZXIpO307Zy5tZHk9X2ZuKGcuZGRkLGcubW9udGgsZy5kYXksZy55ZWFyKTtnLnltZD1fZm4oZy5kZGQsZy55ZWFyLGcubW9udGgsZy5kYXkpO2cuZG15PV9mbihnLmRkZCxnLmRheSxnLm1vbnRoLGcueWVhcik7Zy5kYXRlPWZ1bmN0aW9uKHMpe3JldHVybigoZ1skQy5kYXRlRWxlbWVudE9yZGVyXXx8Zy5tZHkpLmNhbGwodGhpcyxzKSk7fTtnLmZvcm1hdD1fLnByb2Nlc3MoXy5tYW55KF8uYW55KF8ucHJvY2VzcyhfLnJ0b2tlbigvXihkZD9kP2Q/fE1NP00/TT98eXk/eT95P3xoaD98SEg/fG1tP3xzcz98dHQ/fHp6P3o/KS8pLGZ1bmN0aW9uKGZtdCl7aWYoZ1tmbXRdKXtyZXR1cm4gZ1tmbXRdO31lbHNle3Rocm93ICRELlBhcnNpbmcuRXhjZXB0aW9uKGZtdCk7fX0pLF8ucHJvY2VzcyhfLnJ0b2tlbigvXlteZE15aEhtc3R6XSsvKSxmdW5jdGlvbihzKXtyZXR1cm4gXy5pZ25vcmUoXy5zdG9rZW4ocykpO30pKSksZnVuY3Rpb24ocnVsZXMpe3JldHVybiBfLnByb2Nlc3MoXy5lYWNoLmFwcGx5KG51bGwscnVsZXMpLHQuZmluaXNoRXhhY3QpO30pO3ZhciBfRj17fTt2YXIgX2dldD1mdW5jdGlvbihmKXtyZXR1cm4gX0ZbZl09KF9GW2ZdfHxnLmZvcm1hdChmKVswXSk7fTtnLmZvcm1hdHM9ZnVuY3Rpb24oZngpe2lmKGZ4IGluc3RhbmNlb2YgQXJyYXkpe3ZhciByeD1bXTtmb3IodmFyIGk9MDtpPGZ4Lmxlbmd0aDtpKyspe3J4LnB1c2goX2dldChmeFtpXSkpO31cbnJldHVybiBfLmFueS5hcHBseShudWxsLHJ4KTt9ZWxzZXtyZXR1cm4gX2dldChmeCk7fX07Zy5fZm9ybWF0cz1nLmZvcm1hdHMoW1wiXFxcInl5eXktTU0tZGRUSEg6bW06c3NaXFxcIlwiLFwieXl5eS1NTS1kZFRISDptbTpzc1pcIixcInl5eXktTU0tZGRUSEg6bW06c3N6XCIsXCJ5eXl5LU1NLWRkVEhIOm1tOnNzXCIsXCJ5eXl5LU1NLWRkVEhIOm1tWlwiLFwieXl5eS1NTS1kZFRISDptbXpcIixcInl5eXktTU0tZGRUSEg6bW1cIixcImRkZCwgTU1NIGRkLCB5eXl5IEg6bW06c3MgdHRcIixcImRkZCBNTU0gZCB5eXl5IEhIOm1tOnNzIHp6elwiLFwiTU1kZHl5eXlcIixcImRkTU15eXl5XCIsXCJNZGR5eXl5XCIsXCJkZE15eXl5XCIsXCJNZHl5eXlcIixcImRNeXl5eVwiLFwieXl5eVwiLFwiTWR5eVwiLFwiZE15eVwiLFwiZFwiXSk7Zy5fc3RhcnQ9Xy5wcm9jZXNzKF8uc2V0KFtnLmRhdGUsZy50aW1lLGcuZXhwcmVzc2lvbl0sZy5nZW5lcmFsRGVsaW1pdGVyLGcud2hpdGVTcGFjZSksdC5maW5pc2gpO2cuc3RhcnQ9ZnVuY3Rpb24ocyl7dHJ5e3ZhciByPWcuX2Zvcm1hdHMuY2FsbCh7fSxzKTtpZihyWzFdLmxlbmd0aD09PTApe3JldHVybiByO319Y2F0Y2goZSl7fVxucmV0dXJuIGcuX3N0YXJ0LmNhbGwoe30scyk7fTskRC5fcGFyc2U9JEQucGFyc2U7JEQucGFyc2U9ZnVuY3Rpb24ocyl7dmFyIHI9bnVsbDtpZighcyl7cmV0dXJuIG51bGw7fVxuaWYocyBpbnN0YW5jZW9mIERhdGUpe3JldHVybiBzO31cbnRyeXtyPSRELkdyYW1tYXIuc3RhcnQuY2FsbCh7fSxzLnJlcGxhY2UoL15cXHMqKFxcUyooXFxzK1xcUyspKilcXHMqJC8sXCIkMVwiKSk7fWNhdGNoKGUpe3JldHVybiBudWxsO31cbnJldHVybigoclsxXS5sZW5ndGg9PT0wKT9yWzBdOm51bGwpO307JEQuZ2V0UGFyc2VGdW5jdGlvbj1mdW5jdGlvbihmeCl7dmFyIGZuPSRELkdyYW1tYXIuZm9ybWF0cyhmeCk7cmV0dXJuIGZ1bmN0aW9uKHMpe3ZhciByPW51bGw7dHJ5e3I9Zm4uY2FsbCh7fSxzKTt9Y2F0Y2goZSl7cmV0dXJuIG51bGw7fVxucmV0dXJuKChyWzFdLmxlbmd0aD09PTApP3JbMF06bnVsbCk7fTt9OyRELnBhcnNlRXhhY3Q9ZnVuY3Rpb24ocyxmeCl7cmV0dXJuICRELmdldFBhcnNlRnVuY3Rpb24oZngpKHMpO307fSgpKTtcclxuIiwiLy8vPHJlZmVyZW5jZSBwYXRoPVwiLi4vbm9kZV9tb2R1bGVzL2JhY2tib25lLXR5cGluZ3MvYmFja2JvbmUuZC50c1wiLz5cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn07XHJcbnZhciBDYXRlZ29yeUNvdW50ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGZ1bmN0aW9uIENhdGVnb3J5Q291bnQoKSB7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gQ2F0ZWdvcnlDb3VudDtcclxufSgpKTtcclxudmFyIENhdGVnb3J5VmlldyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoQ2F0ZWdvcnlWaWV3LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQ2F0ZWdvcnlWaWV3KG9wdGlvbnMpIHtcclxuICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb25zKTtcclxuICAgICAgICB0aGlzLmNhdGVnb3J5Q291bnQgPSBbXTtcclxuICAgICAgICB0aGlzLnRlbXBsYXRlID0gXy50ZW1wbGF0ZSgkKCcjY2F0ZWdvcnlUZW1wbGF0ZScpLmh0bWwoKSk7XHJcbiAgICAgICAgdGhpcy5zZXRFbGVtZW50KCQoJyNjYXRlZ29yaWVzJykpO1xyXG4gICAgICAgIHRoaXMuY2F0ZWdvcnlDb3VudCA9IFtdO1xyXG4gICAgfVxyXG4gICAgQ2F0ZWdvcnlWaWV3LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICB2YXIgY29udGVudCA9IFtdO1xyXG4gICAgICAgIHZhciBzdW0gPSBfLnJlZHVjZSh0aGlzLmNhdGVnb3J5Q291bnQsIGZ1bmN0aW9uIChtZW1vLCBpdGVtKSB7XHJcbiAgICAgICAgICAgIC8vIG9ubHkgZXhwZW5zZXNcclxuICAgICAgICAgICAgaWYgKGl0ZW0uY2F0TmFtZSAhPSAnRGVmYXVsdCcgJiYgaXRlbS5hbW91bnQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWVtbyArIGl0ZW0uYW1vdW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1lbW87XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAwKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnc3VtJywgc3VtKTtcclxuICAgICAgICB0aGlzLmNhdGVnb3J5Q291bnQgPSBfLnNvcnRCeSh0aGlzLmNhdGVnb3J5Q291bnQsIGZ1bmN0aW9uIChlbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gLWVsLmFtb3VudDtcclxuICAgICAgICB9KS5yZXZlcnNlKCk7XHJcbiAgICAgICAgXy5lYWNoKHRoaXMuY2F0ZWdvcnlDb3VudCwgZnVuY3Rpb24gKGNhdENvdW50KSB7XHJcbiAgICAgICAgICAgIGlmIChjYXRDb3VudC5jYXROYW1lICE9ICdEZWZhdWx0JyAmJiBjYXRDb3VudC5hbW91bnQgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBNYXRoLnJvdW5kKDEwMCAqICgtY2F0Q291bnQuYW1vdW50KSAvIC1zdW0pICsgJyUnO1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coY2F0Q291bnQuY2F0TmFtZSwgd2lkdGgsIGNhdENvdW50LmNvdW50LCBjYXRDb3VudC5hbW91bnQpO1xyXG4gICAgICAgICAgICAgICAgY29udGVudC5wdXNoKF90aGlzLnRlbXBsYXRlKF8uZXh0ZW5kKGNhdENvdW50LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogTWF0aC5yb3VuZChjYXRDb3VudC5hbW91bnQpXHJcbiAgICAgICAgICAgICAgICB9KSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy4kZWwuaHRtbChjb250ZW50LmpvaW4oJ1xcbicpKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH07XHJcbiAgICBDYXRlZ29yeVZpZXcucHJvdG90eXBlLmNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdtb2RlbCBjaGFuZ2VkJywgdGhpcy5tb2RlbC5zaXplKCkpO1xyXG4gICAgICAgIHRoaXMubW9kZWwuZWFjaChmdW5jdGlvbiAodHJhbnNhY3Rpb24pIHtcclxuICAgICAgICAgICAgdmFyIGNhdGVnb3J5TmFtZSA9IHRyYW5zYWN0aW9uLmdldCgnY2F0ZWdvcnknKTtcclxuICAgICAgICAgICAgdmFyIGV4aXN0cyA9IF8uZmluZFdoZXJlKF90aGlzLmNhdGVnb3J5Q291bnQsIHsgY2F0TmFtZTogY2F0ZWdvcnlOYW1lIH0pO1xyXG4gICAgICAgICAgICBpZiAoZXhpc3RzKSB7XHJcbiAgICAgICAgICAgICAgICBleGlzdHMuY291bnQrKztcclxuICAgICAgICAgICAgICAgIGV4aXN0cy5hbW91bnQgKz0gcGFyc2VGbG9hdCh0cmFuc2FjdGlvbi5nZXQoJ2Ftb3VudCcpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLmNhdGVnb3J5Q291bnQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgY2F0TmFtZTogY2F0ZWdvcnlOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50OiAwLFxyXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogMFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLmNhdGVnb3J5Q291bnQpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyKCk7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIENhdGVnb3J5VmlldztcclxufShCYWNrYm9uZS5WaWV3KSk7XHJcbmV4cG9ydHMuX19lc01vZHVsZSA9IHRydWU7XHJcbmV4cG9ydHNbXCJkZWZhdWx0XCJdID0gQ2F0ZWdvcnlWaWV3O1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1DYXRlZ29yeVZpZXcuanMubWFwIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGluZ3MvaW5kZXguZC50c1wiIC8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9ub2RlX21vZHVsZXMvYmFja2JvbmUtdHlwaW5ncy9iYWNrYm9uZS5kLnRzXCIgLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cInVtc2FldHplLnRzXCIgLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIlBhcGEuZC50c1wiIC8+XHJcblwidXNlIHN0cmljdFwiO1xyXG52YXIgX19leHRlbmRzID0gKHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMpIHx8IGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTtcclxuICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxyXG4gICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xyXG59O1xyXG52YXIgdW1zYWV0emVfMSA9IHJlcXVpcmUoJy4vdW1zYWV0emUnKTtcclxudmFyIFRyYW5zYWN0aW9uXzEgPSByZXF1aXJlKCcuL1RyYW5zYWN0aW9uJyk7XHJcbnZhciBFeHBlbnNlcyA9IChmdW5jdGlvbiAoX3N1cGVyKSB7XHJcbiAgICBfX2V4dGVuZHMoRXhwZW5zZXMsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBFeHBlbnNlcygpIHtcclxuICAgICAgICBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubW9kZWwgPSBUcmFuc2FjdGlvbl8xW1wiZGVmYXVsdFwiXTtcclxuICAgICAgICB0aGlzLmNzdlVybCA9ICcuLi91bXNhZXR6ZS0xMDkwNzI5LTIwMTYtMDctMjctMDAtMTEtMjkuY2F0LmNzdic7XHJcbiAgICB9XHJcbiAgICBFeHBlbnNlcy5wcm90b3R5cGUuZmV0Y2ggPSBmdW5jdGlvbiAob3B0aW9ucykge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2NzdlVybCcsIHRoaXMuY3N2VXJsKTtcclxuICAgICAgICByZXR1cm4gJC5nZXQodGhpcy5jc3ZVcmwsIGZ1bmN0aW9uIChyZXNwb25zZSwgeGhyKSB7XHJcbiAgICAgICAgICAgIHZhciBjc3YgPSBQYXBhLnBhcnNlKHJlc3BvbnNlLCB7XHJcbiAgICAgICAgICAgICAgICBoZWFkZXI6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBkeW5hbWljVHlwaW5nOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgc2tpcEVtcHR5TGluZXM6IHRydWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coY3N2KTtcclxuICAgICAgICAgICAgaWYgKGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICBfLmVhY2goY3N2LmRhdGEsIF90aGlzLnByb2Nlc3NSb3cuYmluZChfdGhpcykpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMucHJvY2Vzc0RvbmUoY3N2LmRhdGEubGVuZ3RoLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHVtc2FldHplXzEuYXN5bmNMb29wKGNzdi5kYXRhLCBfdGhpcy5wcm9jZXNzUm93LmJpbmQoX3RoaXMpLCBfdGhpcy5wcm9jZXNzRG9uZS5iaW5kKF90aGlzLCBvcHRpb25zKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbiAgICBFeHBlbnNlcy5wcm90b3R5cGUucHJvY2Vzc1JvdyA9IGZ1bmN0aW9uIChyb3csIGksIGxlbmd0aCkge1xyXG4gICAgICAgIHZhciBwZXJjZW50ID0gTWF0aC5yb3VuZCgxMDAgKiBpIC8gbGVuZ3RoKTtcclxuICAgICAgICAvL2NvbnNvbGUubG9nKHJvdyk7XHJcbiAgICAgICAgJCgnLnByb2dyZXNzIC5wcm9ncmVzcy1iYXInKS53aWR0aChwZXJjZW50ICsgJyUnKTtcclxuICAgICAgICB0aGlzLmFkZChuZXcgVHJhbnNhY3Rpb25fMVtcImRlZmF1bHRcIl0ocm93KSk7XHJcbiAgICAgICAgLy90aGlzLnRyaWdnZXIoJ2NoYW5nZScpO1xyXG4gICAgfTtcclxuICAgIEV4cGVuc2VzLnByb3RvdHlwZS5wcm9jZXNzRG9uZSA9IGZ1bmN0aW9uIChjb3VudCwgb3B0aW9ucykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdhc3luY0xvb3AgZmluaXNoZWQnLCBjb3VudCk7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICBvcHRpb25zLnN1Y2Nlc3MuY2FsbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnRyaWdnZXIoJ2NoYW5nZScpO1xyXG4gICAgfTtcclxuICAgIEV4cGVuc2VzLnByb3RvdHlwZS5nZXREYXRlRnJvbSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgbWluID0gbmV3IERhdGUoKS52YWx1ZU9mKCk7XHJcbiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uIChyb3cpIHtcclxuICAgICAgICAgICAgdmFyIGRhdGUgPSBEYXRlLnBhcnNlKHJvdy5nZXQoJ2RhdGUnKSk7XHJcbiAgICAgICAgICAgIGlmIChkYXRlIDwgbWluKSB7XHJcbiAgICAgICAgICAgICAgICBtaW4gPSBkYXRlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBEYXRlKG1pbik7XHJcbiAgICB9O1xyXG4gICAgRXhwZW5zZXMucHJvdG90eXBlLmdldERhdGVUaWxsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBtaW4gPSBuZXcgRGF0ZSgnMTk3MC0wMS0wMScpLnZhbHVlT2YoKTtcclxuICAgICAgICB0aGlzLmVhY2goZnVuY3Rpb24gKHJvdykge1xyXG4gICAgICAgICAgICB2YXIgZGF0ZSA9IERhdGUucGFyc2Uocm93LmdldCgnZGF0ZScpKTtcclxuICAgICAgICAgICAgaWYgKGRhdGUgPiBtaW4pIHtcclxuICAgICAgICAgICAgICAgIG1pbiA9IGRhdGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gbmV3IERhdGUobWluKTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gRXhwZW5zZXM7XHJcbn0oQmFja2JvbmUuQ29sbGVjdGlvbikpO1xyXG5leHBvcnRzLl9fZXNNb2R1bGUgPSB0cnVlO1xyXG5leHBvcnRzW1wiZGVmYXVsdFwiXSA9IEV4cGVuc2VzO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1FeHBlbnNlcy5qcy5tYXAiLCIvLy88cmVmZXJlbmNlIHBhdGg9XCIuLi9ub2RlX21vZHVsZXMvYmFja2JvbmUtdHlwaW5ncy9iYWNrYm9uZS5kLnRzXCIvPlxyXG5cInVzZSBzdHJpY3RcIjtcclxudmFyIF9fZXh0ZW5kcyA9ICh0aGlzICYmIHRoaXMuX19leHRlbmRzKSB8fCBmdW5jdGlvbiAoZCwgYikge1xyXG4gICAgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufTtcclxudmFyIFRyYW5zYWN0aW9uID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhUcmFuc2FjdGlvbiwgX3N1cGVyKTtcclxuICAgIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKCkge1xyXG4gICAgICAgIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gICAgfVxyXG4gICAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLnNpZ24gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYW1vdW50ID49IDAgPyAncG9zaXRpdmUnIDogJ25lZ2F0aXZlJztcclxuICAgIH07XHJcbiAgICBUcmFuc2FjdGlvbi5wcm90b3R5cGUudG9KU09OID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBqc29uID0gX3N1cGVyLnByb3RvdHlwZS50b0pTT04uY2FsbCh0aGlzKTtcclxuICAgICAgICBqc29uLnNpZ24gPSB0aGlzLnNpZ24oKTtcclxuICAgICAgICByZXR1cm4ganNvbjtcclxuICAgIH07XHJcbiAgICByZXR1cm4gVHJhbnNhY3Rpb247XHJcbn0oQmFja2JvbmUuTW9kZWwpKTtcclxuZXhwb3J0cy5fX2VzTW9kdWxlID0gdHJ1ZTtcclxuZXhwb3J0c1tcImRlZmF1bHRcIl0gPSBUcmFuc2FjdGlvbjtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9VHJhbnNhY3Rpb24uanMubWFwIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGluZ3MvaW5kZXguZC50c1wiIC8+XHJcbi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9ub2RlX21vZHVsZXMvYmFja2JvbmUtdHlwaW5ncy9iYWNrYm9uZS5kLnRzXCIgLz5cclxuLy8vIDxyZWZlcmVuY2UgcGF0aD1cIkV4cGVuc2VzLnRzXCIgLz5cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcbnZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgZnVuY3Rpb24gKGQsIGIpIHtcclxuICAgIGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdO1xyXG4gICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XHJcbiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbn07XHJcbmZ1bmN0aW9uIGFzeW5jTG9vcChhcnIsIGNhbGxiYWNrLCBkb25lKSB7XHJcbiAgICAoZnVuY3Rpb24gbG9vcChpKSB7XHJcbiAgICAgICAgY2FsbGJhY2soYXJyW2ldLCBpLCBhcnIubGVuZ3RoKTsgLy9jYWxsYmFjayB3aGVuIHRoZSBsb29wIGdvZXMgb25cclxuICAgICAgICBpZiAoaSA8IGFyci5sZW5ndGgpIHtcclxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IGxvb3AoKytpKTsgfSwgMSk7IC8vcmVydW4gd2hlbiBjb25kaXRpb24gaXMgdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGRvbmUpIHtcclxuICAgICAgICAgICAgICAgIGRvbmUoYXJyLmxlbmd0aCk7IC8vY2FsbGJhY2sgd2hlbiB0aGUgbG9vcCBlbmRzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KDApKTsgLy9zdGFydCB3aXRoIDBcclxufVxyXG5leHBvcnRzLmFzeW5jTG9vcCA9IGFzeW5jTG9vcDtcclxudmFyIEV4cGVuc2VzXzEgPSByZXF1aXJlKCcuL0V4cGVuc2VzJyk7XHJcbnJlcXVpcmUoJ2RhdGVqcycpO1xyXG52YXIgRXhwZW5zZVRhYmxlID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhFeHBlbnNlVGFibGUsIF9zdXBlcik7XHJcbiAgICBmdW5jdGlvbiBFeHBlbnNlVGFibGUob3B0aW9ucykge1xyXG4gICAgICAgIF9zdXBlci5jYWxsKHRoaXMsIG9wdGlvbnMpO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRvbyBlYXJseSwgd2FpdCB1bnRpbCBpbml0aWFsaXplKClcclxuICAgICAgICAgKiBAdHlwZSB7SlF1ZXJ5fVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIC8vZWwgPSAkKCcjZXhwZW5zZVRhYmxlJyk7XHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZSA9IF8udGVtcGxhdGUoJCgnI3Jvd1RlbXBsYXRlJykuaHRtbCgpKTtcclxuICAgICAgICB0aGlzLnNldEVsZW1lbnQoJCgnI2V4cGVuc2VUYWJsZScpKTtcclxuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsICdjaGFuZ2UnLCB0aGlzLnJlbmRlcik7XHJcbiAgICB9XHJcbiAgICBFeHBlbnNlVGFibGUucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdFeHBlbnNlVGFibGUucmVuZGVyKCknLCB0aGlzLm1vZGVsLnNpemUoKSk7XHJcbiAgICAgICAgY29uc29sZS5sb2codGhpcy5tb2RlbCk7XHJcbiAgICAgICAgdmFyIHJvd3MgPSBbXTtcclxuICAgICAgICB0aGlzLm1vZGVsLmVhY2goZnVuY3Rpb24gKHRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2codHJhbnNhY3Rpb24pO1xyXG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlcyA9IHRyYW5zYWN0aW9uLnRvSlNPTigpO1xyXG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eSgnZGF0ZScpKSB7XHJcbiAgICAgICAgICAgICAgICByb3dzLnB1c2goX3RoaXMudGVtcGxhdGUoYXR0cmlidXRlcykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25vIGRhdGUnLCBhdHRyaWJ1dGVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdyZW5kZXJpbmcnLCByb3dzLmxlbmd0aCwgJ3Jvd3MnKTtcclxuICAgICAgICB0aGlzLiRlbC5hcHBlbmQocm93cy5qb2luKCdcXG4nKSk7XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLiRlbCk7XHJcbiAgICAgICAgJCgnI2RhdGVGcm9tJykuaHRtbCh0aGlzLm1vZGVsLmdldERhdGVGcm9tKCkudG9TdHJpbmcoJ3l5eXktTU0tZGQnKSk7XHJcbiAgICAgICAgJCgnI2RhdGVUaWxsJykuaHRtbCh0aGlzLm1vZGVsLmdldERhdGVUaWxsKCkudG9TdHJpbmcoJ3l5eXktTU0tZGQnKSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEV4cGVuc2VUYWJsZTtcclxufShCYWNrYm9uZS5WaWV3KSk7XHJcbnZhciBDYXRlZ29yeVZpZXdfMSA9IHJlcXVpcmUoJy4vQ2F0ZWdvcnlWaWV3Jyk7XHJcbnZhciBBcHBWaWV3ID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcclxuICAgIF9fZXh0ZW5kcyhBcHBWaWV3LCBfc3VwZXIpO1xyXG4gICAgZnVuY3Rpb24gQXBwVmlldyhvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcclxuICAgICAgICBfc3VwZXIuY2FsbCh0aGlzLCBvcHRpb25zKTtcclxuICAgICAgICBjb25zb2xlLmxvZygnY29uc3RydWN0IEFwcFZpZXcnKTtcclxuICAgICAgICB0aGlzLnNldEVsZW1lbnQoJCgnI2FwcCcpKTtcclxuICAgICAgICB0aGlzLm1vZGVsID0gbmV3IEV4cGVuc2VzXzFbXCJkZWZhdWx0XCJdKCk7XHJcbiAgICAgICAgdGhpcy50YWJsZSA9IG5ldyBFeHBlbnNlVGFibGUoe1xyXG4gICAgICAgICAgICBtb2RlbDogdGhpcy5tb2RlbCxcclxuICAgICAgICAgICAgZWw6ICQoJyNleHBlbnNlVGFibGUnKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuY2F0ZWdvcmllcyA9IG5ldyBDYXRlZ29yeVZpZXdfMVtcImRlZmF1bHRcIl0oe1xyXG4gICAgICAgICAgICBtb2RlbDogdGhpcy5tb2RlbFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuc3RhcnRMb2FkaW5nKCk7XHJcbiAgICAgICAgdGhpcy5tb2RlbC5mZXRjaCh7XHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIF90aGlzLnN0b3BMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmxpc3RlblRvKHRoaXMubW9kZWwsIFwiY2hhbmdlXCIsIHRoaXMucmVuZGVyLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMubGlzdGVuVG8odGhpcy5tb2RlbCwgXCJjaGFuZ2VcIiwgdGhpcy5jYXRlZ29yaWVzLmNoYW5nZS5iaW5kKHRoaXMuY2F0ZWdvcmllcykpO1xyXG4gICAgfVxyXG4gICAgQXBwVmlldy5wcm90b3R5cGUuc3RhcnRMb2FkaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdzdGFydExvYWRpbmcnKTtcclxuICAgICAgICB2YXIgdGVtcGxhdGUgPSBfLnRlbXBsYXRlKCQoJyNsb2FkaW5nQmFyJykuaHRtbCgpKTtcclxuICAgICAgICB0aGlzLiRlbC5odG1sKHRlbXBsYXRlKCkpO1xyXG4gICAgfTtcclxuICAgIEFwcFZpZXcucHJvdG90eXBlLnN0b3BMb2FkaW5nID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdzdG9wTG9hZGluZycpO1xyXG4gICAgICAgIHRoaXMuJGVsLmh0bWwoJ0RvbmUnKTtcclxuICAgIH07XHJcbiAgICBBcHBWaWV3LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0FwcFZpZXcucmVuZGVyKCknLCB0aGlzLm1vZGVsKTtcclxuICAgICAgICBpZiAodGhpcy5tb2RlbCAmJiB0aGlzLm1vZGVsLnNpemUoKSkge1xyXG4gICAgICAgICAgICB0aGlzLnRhYmxlLnJlbmRlcigpO1xyXG4gICAgICAgICAgICB0aGlzLiRlbC5odG1sKCdUYWJsZSBzaG93bicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zdGFydExvYWRpbmcoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9O1xyXG4gICAgcmV0dXJuIEFwcFZpZXc7XHJcbn0oQmFja2JvbmUuVmlldykpO1xyXG4kKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBhcHAgPSBuZXcgQXBwVmlldygpO1xyXG4gICAgYXBwLnJlbmRlcigpO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dW1zYWV0emUuanMubWFwIl19
